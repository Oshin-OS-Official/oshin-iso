define(["core/CoreAPI"],API=>{async function getList(key){key=await API.Storage.getAsync(key);return"object"!=typeof(key??={})?[]:Object.keys(key)}return{getBlocklist(){return getList("blacklist")},getAllowlist(){return getList("whitelist")},isHostnameBlocked(hostname,blocklist,allowlist){blocklist=blocklist.some(wildcard=>API.Domain.matchesWildcard(wildcard,hostname)),allowlist=allowlist.some(wildcard=>API.Domain.matchesWildcard(wildcard,hostname));return blocklist&&!allowlist}}});