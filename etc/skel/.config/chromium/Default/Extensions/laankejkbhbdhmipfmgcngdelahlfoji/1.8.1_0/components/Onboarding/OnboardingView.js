define(["core/CoreAPI","core/vendor/DropletJS.PubSub.min","core/vendor/Brightline.min","core/vendor/text!components/Onboarding/onboarding.tpl"],function(API,PubSub,Brightline,onboardingTpl){return class{model=null;constructor(model){this.model=model}init(){document.body.innerHTML=this.render(),API.StayFocusd.localizeHTML(document),this.bindUIHandlers(),this.rerender()}render(){var template=new Brightline(onboardingTpl);return template.set("referrer",this.model.referrer),template.set("isExistingUser",this.model.isExistingUser),template.set("isModal",this.model.isModal),template.set("modalPosition",this.model.modalPosition),template.set("hasAcceptedToS",this.model.hasAcceptedToS),template.set("hasAcceptedPrivacyPolicy",this.model.hasAcceptedPrivacyPolicy),template.set("is18OrOlder",this.model.is18OrOlder),template.set("age",this.model.age),template.set("extensionURL",API.Chrome.Extension.getURL("/")),template.render()}bindUIHandlers(){document.querySelectorAll(".btn").forEach(btn=>{btn.addEventListener("click",()=>{PubSub.publish("OnboardingView.button.clicked",{id:btn.id})})}),document.querySelectorAll('input[type="checkbox"]').forEach(checkbox=>{checkbox.addEventListener("click",e=>{PubSub.publish("OnboardingView.checkbox.checked",{id:checkbox.id,isChecked:e.target.checked})})}),document.querySelectorAll("select").forEach(select=>{select.addEventListener("change",e=>{PubSub.publish("OnboardingView.select.changed",{id:select.id,value:e.target.value})})}),API.Analytics.bindHtmlEvents()}rerender(){var{hasAcceptedToS,hasAcceptedPrivacyPolicy,is18OrOlder,age,isExistingUser,confirmationCount,isConfirmingPrivacy}=this.model,isConfirmingPrivacy=isConfirmingPrivacy?"confirm":isExistingUser?"existing":"new";this.setVisible("newUserHeader","new"==isConfirmingPrivacy),this.setVisible("existingUserHeader","existing"==isConfirmingPrivacy),this.setVisible("confirmPrivacyPolicyHeader","confirm"==isConfirmingPrivacy),this.setVisible("ageCheckbox","confirm"!=isConfirmingPrivacy),this.setVisible("ageOver18",is18OrOlder),this.setChecked("isAge18",is18OrOlder),this.setVisible("ageUnder18Checkbox",!is18OrOlder),this.setVisible("ageSelect",!is18OrOlder),this.setValue("ageSelect",age),this.setVisible("acceptedToSCheckbox","confirm"!=isConfirmingPrivacy),this.setDisabled("acceptedToSCheckbox",!is18OrOlder),this.setCrossOut("acceptedToSCheckbox",!is18OrOlder),this.setChecked("hasAcceptedToS",is18OrOlder&&hasAcceptedToS),this.setDisabled("hasAcceptedToS",!is18OrOlder),this.setVisible("declineToSMessage",!hasAcceptedToS&&is18OrOlder),this.setVisible("acceptedPrivacyPolicyCheckbox",!0),this.setDisabled("acceptedPrivacyPolicyCheckbox",!is18OrOlder),this.setCrossOut("acceptedPrivacyPolicyCheckbox",!is18OrOlder),this.setChecked("hasAcceptedPrivacyPolicy",is18OrOlder&&hasAcceptedPrivacyPolicy),this.setDisabled("hasAcceptedPrivacyPolicy",!is18OrOlder),this.setVisible("under18Message",!is18OrOlder),this.setVisible("privacyPolicySummary",is18OrOlder),this.setVisible("btnDecline","confirm"==isConfirmingPrivacy&&2<=confirmationCount),this.setVisible("btnAskLater","confirm"==isConfirmingPrivacy&&confirmationCount<2),this.setVisible("btnContinue",!is18OrOlder),this.setVisible("btnAccept",is18OrOlder),this.setDisabled("btnAccept",!hasAcceptedToS||"confirm"==isConfirmingPrivacy&&!hasAcceptedPrivacyPolicy)}setVisible(id,isVisible){id=document.getElementById(id);id&&(isVisible?id.classList.remove("hidden"):id.classList.add("hidden"))}setCrossOut(id,isCrossedOut){id=document.getElementById(id);id&&(isCrossedOut?id.classList.add("line-through"):id.classList.remove("line-through"))}setDisabled(id,isDisabled){id=document.getElementById(id);id&&(isDisabled?id.setAttribute("disabled","true"):id.removeAttribute("disabled"))}setChecked(id,isChecked){id=document.getElementById(id);id&&(id.checked=isChecked)}setValue(id,value){id=document.getElementById(id);id&&(null!=value?id.value=value:id.removeAttribute("value"))}}});