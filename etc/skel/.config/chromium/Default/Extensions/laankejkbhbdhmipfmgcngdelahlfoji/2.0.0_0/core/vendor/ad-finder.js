var adFinder=function(L){"use strict";typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;var G={exports:{}};typeof globalThis<"u"?globalThis:typeof self<"u"&&self,function(n){var d,h;if(!((h=(d=globalThis.chrome)==null?void 0:d.runtime)!=null&&h.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const u="The message port closed before a response was received.",y=p=>{const o={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(o).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(g,x=void 0){super(x),this.createItem=g}get(g){return this.has(g)||this.set(g,this.createItem(g)),super.get(g)}}const s=e=>e&&typeof e=="object"&&typeof e.then=="function",c=(e,g)=>(...x)=>{p.runtime.lastError?e.reject(new Error(p.runtime.lastError.message)):g.singleCallbackArg||x.length<=1&&g.singleCallbackArg!==!1?e.resolve(x[0]):e.resolve(x)},l=e=>e==1?"argument":"arguments",b=(e,g)=>function(S,...N){if(N.length<g.minArgs)throw new Error(`Expected at least ${g.minArgs} ${l(g.minArgs)} for ${e}(), got ${N.length}`);if(N.length>g.maxArgs)throw new Error(`Expected at most ${g.maxArgs} ${l(g.maxArgs)} for ${e}(), got ${N.length}`);return new Promise((k,I)=>{if(g.fallbackToNoCallback)try{S[e](...N,c({resolve:k,reject:I},g))}catch(w){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,w),S[e](...N),g.fallbackToNoCallback=!1,g.noCallback=!0,k()}else g.noCallback?(S[e](...N),k()):S[e](...N,c({resolve:k,reject:I},g))})},O=(e,g,x)=>new Proxy(g,{apply(S,N,k){return x.call(N,e,...k)}});let T=Function.call.bind(Object.prototype.hasOwnProperty);const P=(e,g={},x={})=>{let S=Object.create(null),N={has(I,w){return w in e||w in S},get(I,w,M){if(w in S)return S[w];if(!(w in e))return;let C=e[w];if(typeof C=="function")if(typeof g[w]=="function")C=O(e,e[w],g[w]);else if(T(x,w)){let F=b(w,x[w]);C=O(e,e[w],F)}else C=C.bind(e);else if(typeof C=="object"&&C!==null&&(T(g,w)||T(x,w)))C=P(C,g[w],x[w]);else if(T(x,"*"))C=P(C,g[w],x["*"]);else return Object.defineProperty(S,w,{configurable:!0,enumerable:!0,get(){return e[w]},set(F){e[w]=F}}),C;return S[w]=C,C},set(I,w,M,C){return w in S?S[w]=M:e[w]=M,!0},defineProperty(I,w,M){return Reflect.defineProperty(S,w,M)},deleteProperty(I,w){return Reflect.deleteProperty(S,w)}},k=Object.create(e);return new Proxy(k,N)},_=e=>({addListener(g,x,...S){g.addListener(e.get(x),...S)},hasListener(g,x){return g.hasListener(e.get(x))},removeListener(g,x){g.removeListener(e.get(x))}}),v=new a(e=>typeof e!="function"?e:function(x){const S=P(x,{},{getContent:{minArgs:0,maxArgs:0}});e(S)}),E=new a(e=>typeof e!="function"?e:function(x,S,N){let k=!1,I,w=new Promise(B=>{I=function(R){k=!0,B(R)}}),M;try{M=e(x,S,I)}catch(B){M=Promise.reject(B)}const C=M!==!0&&s(M);if(M!==!0&&!C&&!k)return!1;const F=B=>{B.then(R=>{N(R)},R=>{let H;R&&(R instanceof Error||typeof R.message=="string")?H=R.message:H="An unexpected error occurred",N({__mozWebExtensionPolyfillReject__:!0,message:H})}).catch(R=>{console.error("Failed to send onMessage rejected reply",R)})};return F(C?M:w),!0}),m=({reject:e,resolve:g},x)=>{p.runtime.lastError?p.runtime.lastError.message===u?g():e(new Error(p.runtime.lastError.message)):x&&x.__mozWebExtensionPolyfillReject__?e(new Error(x.message)):g(x)},A=(e,g,x,...S)=>{if(S.length<g.minArgs)throw new Error(`Expected at least ${g.minArgs} ${l(g.minArgs)} for ${e}(), got ${S.length}`);if(S.length>g.maxArgs)throw new Error(`Expected at most ${g.maxArgs} ${l(g.maxArgs)} for ${e}(), got ${S.length}`);return new Promise((N,k)=>{const I=m.bind(null,{resolve:N,reject:k});S.push(I),x.sendMessage(...S)})},i={devtools:{network:{onRequestFinished:_(v)}},runtime:{onMessage:_(E),onMessageExternal:_(E),sendMessage:A.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:A.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},f={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return o.privacy={network:{"*":f},services:{"*":f},websites:{"*":f}},P(p,i,o)};n.exports=y(chrome)}else n.exports=globalThis.browser}(G);const D=G.exports;G={exports:{}};!function(t){n=String.fromCharCode,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",u={};var n,d,h,u,p,r=p={compressToBase64:function(o){if(null==o)return"";var a=p._compress(o,6,function(s){return d.charAt(s)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(o){return null==o?"":""==o?null:p._decompress(o.length,32,function(a){return y(d,o.charAt(a))})},compressToUTF16:function(o){return null==o?"":p._compress(o,15,function(a){return n(a+32)})+" "},decompressFromUTF16:function(o){return null==o?"":""==o?null:p._decompress(o.length,16384,function(a){return o.charCodeAt(a)-32})},compressToUint8Array:function(o){for(var a=p.compress(o),s=new Uint8Array(2*a.length),c=0,l=a.length;c<l;c++){var b=a.charCodeAt(c);s[2*c]=b>>>8,s[2*c+1]=b%256}return s},decompressFromUint8Array:function(o){if(null==o)return p.decompress(o);for(var a=new Array(o.length/2),s=0,c=a.length;s<c;s++)a[s]=256*o[2*s]+o[2*s+1];var l=[];return a.forEach(function(b){l.push(n(b))}),p.decompress(l.join(""))},compressToEncodedURIComponent:function(o){return null==o?"":p._compress(o,6,function(a){return h.charAt(a)})},decompressFromEncodedURIComponent:function(o){return null==o?"":""==o?null:(o=o.replace(/ /g,"+"),p._decompress(o.length,32,function(a){return y(h,o.charAt(a))}))},compress:function(o){return p._compress(o,16,function(a){return n(a)})},_compress:function(o,a,s){if(null==o)return"";for(var c,l,T,P,b={},O={},_="",v=2,E=3,m=2,A=[],i=0,f=0,e=0;e<o.length;e+=1)if(T=o.charAt(e),Object.prototype.hasOwnProperty.call(b,T)||(b[T]=E++,O[T]=!0),P=_+T,Object.prototype.hasOwnProperty.call(b,P))_=P;else{if(Object.prototype.hasOwnProperty.call(O,_)){if(_.charCodeAt(0)<256){for(c=0;c<m;c++)i<<=1,f==a-1?(f=0,A.push(s(i)),i=0):f++;for(l=_.charCodeAt(0),c=0;c<8;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1}else{for(l=1,c=0;c<m;c++)i=i<<1|l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l=0;for(l=_.charCodeAt(0),c=0;c<16;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1}0==--v&&(v=Math.pow(2,m),m++),delete O[_]}else for(l=b[_],c=0;c<m;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1;0==--v&&(v=Math.pow(2,m),m++),b[P]=E++,_=String(T)}if(""!==_){if(Object.prototype.hasOwnProperty.call(O,_)){if(_.charCodeAt(0)<256){for(c=0;c<m;c++)i<<=1,f==a-1?(f=0,A.push(s(i)),i=0):f++;for(l=_.charCodeAt(0),c=0;c<8;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1}else{for(l=1,c=0;c<m;c++)i=i<<1|l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l=0;for(l=_.charCodeAt(0),c=0;c<16;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1}0==--v&&(v=Math.pow(2,m),m++),delete O[_]}else for(l=b[_],c=0;c<m;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1;0==--v&&(v=Math.pow(2,m),m++)}for(l=2,c=0;c<m;c++)i=i<<1|1&l,f==a-1?(f=0,A.push(s(i)),i=0):f++,l>>=1;for(;;){if(i<<=1,f==a-1){A.push(s(i));break}f++}return A.join("")},decompress:function(o){return null==o?"":""==o?null:p._decompress(o.length,32768,function(a){return o.charCodeAt(a)})},_decompress:function(o,a,s){for(var v,E,m,A,i,f,c=[],l=4,b=4,O=3,T="",P=[],e={val:s(0),position:a,index:1},_=0;_<3;_+=1)c[_]=_;for(E=0,A=Math.pow(2,2),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;switch(E){case 0:for(E=0,A=Math.pow(2,8),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;f=n(E);break;case 1:for(E=0,A=Math.pow(2,16),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;f=n(E);break;case 2:return""}for(v=c[3]=f,P.push(f);;){if(o<e.index)return"";for(E=0,A=Math.pow(2,O),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;switch(f=E){case 0:for(E=0,A=Math.pow(2,8),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;c[b++]=n(E),f=b-1,l--;break;case 1:for(E=0,A=Math.pow(2,16),i=1;i!=A;)m=e.val&e.position,e.position>>=1,0==e.position&&(e.position=a,e.val=s(e.index++)),E|=(0<m?1:0)*i,i<<=1;c[b++]=n(E),f=b-1,l--;break;case 2:return P.join("")}if(0==l&&(l=Math.pow(2,O),O++),c[f])T=c[f];else{if(f!==b)return null;T=v+v.charAt(0)}P.push(T),c[b++]=v+T.charAt(0),v=T,0==--l&&(l=Math.pow(2,O),O++)}}};function y(o,a){if(!u[o]){u[o]={};for(var s=0;s<o.length;s++)u[o][o.charAt(s)]=s}return u[o][a]}null!=t&&(t.exports=r)}(G);const W=G.exports;async function J(t){if(!t.byteLength)return"";const r=new Blob([t]),n=await new Promise((d,h)=>{const u=new FileReader;u.onload=()=>{"string"==typeof u.result&&d(u.result),h(Error("Failed to read buffer as string, got "+typeof u.result))},u.onerror=()=>h(u.error),u.onabort=()=>h("FileReader aborted"),u.readAsDataURL(r)});return(null==n?void 0:n.split(",").pop())||""}var U=(t=>(t.UPLOAD_CRAWL="ads#CRAWL",t.GET_PM_EXTERNAL_CONFIG="ads#GET_EXTERNAL_CONFIGURATION",t.FETCH_HTTP_RESPONSE="ads#FETCH_HTTP_RESPONSE",t))({});async function z(t,r){var n={};n[t]=r,await D.storage.local.set(n)}async function X(t,r,n){let d=await(n?null:async function(t){return(await D.storage.local.get(t))[t]}(t));return null==d&&await z(t,d=await r()),d}function K(t){return t.split(".").slice(t.endsWith(".uk")||t.endsWith(".jp")?-3:-2).join(".")}async function Y(t){var r=await X("configTs",Date.now);return X("config",async()=>{var h=await t({type:U.GET_PM_EXTERNAL_CONFIG,payload:void 0}),h=JSON.parse(h);return h.TimeOffset=h.Now&&Date.now()-h.Now||0,function(t){null!=(t=t.AdRules)&&t.forEach(n=>{var h=null!=(h=W.decompressFromUTF16(n.ParseTreeString||""))?h:"";n.ParseTree=JSON.parse(h),delete n.ParseTreeString})}(h),function(t){var r;t.ParsedSiteConfigs=null==(r=t.SiteConfigs)?void 0:r.reduce((n,d)=>(n[d.d]=d.r,n),{}),delete t.SiteConfigs}(h),function(t){var r;t.ParsedUrlBlackList=null==(r=t.UrlBlackList)?void 0:r.filter(n=>n.BlockAllAds).reduce((n,d)=>{var h,u;return(null!=(u=n[h=K(d.Hostname)])?u:n[h]=[]).push(d.UrlRegex),n},{}),delete t.UrlBlackList}(h),z("configTs",Date.now()),h},18e5<Date.now()-r)}function Z(){return window.self===window.top}class le{constructor(r){this.config=r}async inject(r){return new Promise((n,d)=>{const h=this.defineOnCspError(d),u=()=>{var y;try{document.addEventListener("securitypolicyviolation",h);const p=document.createElement(r),o=()=>{var c,l;this.config.keepInDom||p.remove(),null!=(l=(c=this.config).onInjected)&&l.call(c)},a=this.getManifestVersion();3===a?p.onload=o:setTimeout(o),this.setSrc(p,a),null!=(y=this.config.logger)&&y.log(p);var s=document.documentElement.firstElementChild;null!=s&&s.insertBefore(p,s.firstChild),document.removeEventListener("securitypolicyviolation",h),n()}catch(p){d(p)}finally{document.removeEventListener("DOMContentLoaded",u)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",u):u()})}defineOnCspError(r){return n=>{null!=r&&r(Error("Blocked by CSP: "+JSON.stringify({host:window.location.hostname,blockedUri:n.blockedURI,violatedDirective:n.violatedDirective,originalPolicy:n.originalPolicy})))}}getManifestVersion(){return"number"==typeof __AD_FINDER_MANIFEST_VERSION__?__AD_FINDER_MANIFEST_VERSION__:D.runtime.getManifest().manifest_version}setSrc(r,n){if(3===n){if(!this.config.mv3Path)throw Error("mv3Path config must be passed for Manifest V3 extensions");r.src=D.runtime.getURL(this.config.mv3Path)}else{if(2!==n)throw Error("Unsupported manifest version "+n);if(!this.config.mv2Content)throw Error("mv2Content config must be passed for Manifest V2 extensions");r.innerHTML=this.config.mv2Content}}}class ce{constructor(r){this.config=r}sendMessage(r,n,d,h){window.postMessage({type:r,payload:n,nonce:h},"*",d)}onMessage(r,n){window.addEventListener("message",async d=>{var l,c,a,{type:d,payload:u,nonce:y}=null!=(d=d.data)?d:{};d===r&&(null!=(c=this.config.logger)&&c.debug("[ad-finder-custom-event] Recieved message:",{type:d,payload:u}),void 0!==(c=await n(u)))&&({response:c,transferables:a}=c,null!=(l=this.config.logger)&&l.debug("[ad-finder-custom-event] Sending response:",{name:d,payload:u,response:c}),this.sendMessage(d+this.config.responseSuffix,c,a,y))})}}const j=class{constructor(t){this.config=t,this.injector=new le({logger:t.logger,keepInDom:t.keepPathmaticsInDom,mv2Content:`"use strict";(()=>{var hr=Object.create;var Dt=Object.defineProperty;var fr=Object.getOwnPropertyDescriptor;var dr=Object.getOwnPropertyNames;var pr=Object.getPrototypeOf,mr=Object.prototype.hasOwnProperty;var gr=(t,r,e)=>r in t?Dt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var yr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var wr=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of dr(r))!mr.call(t,s)&&s!==e&&Dt(t,s,{get:()=>r[s],enumerable:!(n=fr(r,s))||n.enumerable});return t};var _e=(t,r,e)=>(e=t!=null?hr(pr(t)):{},wr(r||!t||!t.__esModule?Dt(e,"default",{value:t,enumerable:!0}):e,t));var v=(t,r,e)=>(gr(t,typeof r!="symbol"?r+"":r,e),e),Ae=(t,r,e)=>{if(!r.has(t))throw TypeError("Cannot "+e)};var k=(t,r,e)=>(Ae(t,r,"read from private field"),e?e.call(t):r.get(t)),L=(t,r,e)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,e)};var V=(t,r,e)=>(Ae(t,r,"access private method"),e);var Lt=yr((be,xe)=>{(function(t){if(typeof be=="object")xe.exports=t();else if(typeof define=="function"&&define.amd)define(t);else{var r;try{r=window}catch{r=self}r.SparkMD5=t()}})(function(t){"use strict";var r=function(f,l){return f+l&4294967295},e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(f,l,o,i,c,a){return l=r(r(l,f),r(i,a)),r(l<<c|l>>>32-c,o)}function s(f,l){var o=f[0],i=f[1],c=f[2],a=f[3];o+=(i&c|~i&a)+l[0]-680876936|0,o=(o<<7|o>>>25)+i|0,a+=(o&i|~o&c)+l[1]-389564586|0,a=(a<<12|a>>>20)+o|0,c+=(a&o|~a&i)+l[2]+606105819|0,c=(c<<17|c>>>15)+a|0,i+=(c&a|~c&o)+l[3]-1044525330|0,i=(i<<22|i>>>10)+c|0,o+=(i&c|~i&a)+l[4]-176418897|0,o=(o<<7|o>>>25)+i|0,a+=(o&i|~o&c)+l[5]+1200080426|0,a=(a<<12|a>>>20)+o|0,c+=(a&o|~a&i)+l[6]-1473231341|0,c=(c<<17|c>>>15)+a|0,i+=(c&a|~c&o)+l[7]-45705983|0,i=(i<<22|i>>>10)+c|0,o+=(i&c|~i&a)+l[8]+1770035416|0,o=(o<<7|o>>>25)+i|0,a+=(o&i|~o&c)+l[9]-1958414417|0,a=(a<<12|a>>>20)+o|0,c+=(a&o|~a&i)+l[10]-42063|0,c=(c<<17|c>>>15)+a|0,i+=(c&a|~c&o)+l[11]-1990404162|0,i=(i<<22|i>>>10)+c|0,o+=(i&c|~i&a)+l[12]+1804603682|0,o=(o<<7|o>>>25)+i|0,a+=(o&i|~o&c)+l[13]-40341101|0,a=(a<<12|a>>>20)+o|0,c+=(a&o|~a&i)+l[14]-1502002290|0,c=(c<<17|c>>>15)+a|0,i+=(c&a|~c&o)+l[15]+1236535329|0,i=(i<<22|i>>>10)+c|0,o+=(i&a|c&~a)+l[1]-165796510|0,o=(o<<5|o>>>27)+i|0,a+=(o&c|i&~c)+l[6]-1069501632|0,a=(a<<9|a>>>23)+o|0,c+=(a&i|o&~i)+l[11]+643717713|0,c=(c<<14|c>>>18)+a|0,i+=(c&o|a&~o)+l[0]-373897302|0,i=(i<<20|i>>>12)+c|0,o+=(i&a|c&~a)+l[5]-701558691|0,o=(o<<5|o>>>27)+i|0,a+=(o&c|i&~c)+l[10]+38016083|0,a=(a<<9|a>>>23)+o|0,c+=(a&i|o&~i)+l[15]-660478335|0,c=(c<<14|c>>>18)+a|0,i+=(c&o|a&~o)+l[4]-405537848|0,i=(i<<20|i>>>12)+c|0,o+=(i&a|c&~a)+l[9]+568446438|0,o=(o<<5|o>>>27)+i|0,a+=(o&c|i&~c)+l[14]-1019803690|0,a=(a<<9|a>>>23)+o|0,c+=(a&i|o&~i)+l[3]-187363961|0,c=(c<<14|c>>>18)+a|0,i+=(c&o|a&~o)+l[8]+1163531501|0,i=(i<<20|i>>>12)+c|0,o+=(i&a|c&~a)+l[13]-1444681467|0,o=(o<<5|o>>>27)+i|0,a+=(o&c|i&~c)+l[2]-51403784|0,a=(a<<9|a>>>23)+o|0,c+=(a&i|o&~i)+l[7]+1735328473|0,c=(c<<14|c>>>18)+a|0,i+=(c&o|a&~o)+l[12]-1926607734|0,i=(i<<20|i>>>12)+c|0,o+=(i^c^a)+l[5]-378558|0,o=(o<<4|o>>>28)+i|0,a+=(o^i^c)+l[8]-2022574463|0,a=(a<<11|a>>>21)+o|0,c+=(a^o^i)+l[11]+1839030562|0,c=(c<<16|c>>>16)+a|0,i+=(c^a^o)+l[14]-35309556|0,i=(i<<23|i>>>9)+c|0,o+=(i^c^a)+l[1]-1530992060|0,o=(o<<4|o>>>28)+i|0,a+=(o^i^c)+l[4]+1272893353|0,a=(a<<11|a>>>21)+o|0,c+=(a^o^i)+l[7]-155497632|0,c=(c<<16|c>>>16)+a|0,i+=(c^a^o)+l[10]-1094730640|0,i=(i<<23|i>>>9)+c|0,o+=(i^c^a)+l[13]+681279174|0,o=(o<<4|o>>>28)+i|0,a+=(o^i^c)+l[0]-358537222|0,a=(a<<11|a>>>21)+o|0,c+=(a^o^i)+l[3]-722521979|0,c=(c<<16|c>>>16)+a|0,i+=(c^a^o)+l[6]+76029189|0,i=(i<<23|i>>>9)+c|0,o+=(i^c^a)+l[9]-640364487|0,o=(o<<4|o>>>28)+i|0,a+=(o^i^c)+l[12]-421815835|0,a=(a<<11|a>>>21)+o|0,c+=(a^o^i)+l[15]+530742520|0,c=(c<<16|c>>>16)+a|0,i+=(c^a^o)+l[2]-995338651|0,i=(i<<23|i>>>9)+c|0,o+=(c^(i|~a))+l[0]-198630844|0,o=(o<<6|o>>>26)+i|0,a+=(i^(o|~c))+l[7]+1126891415|0,a=(a<<10|a>>>22)+o|0,c+=(o^(a|~i))+l[14]-1416354905|0,c=(c<<15|c>>>17)+a|0,i+=(a^(c|~o))+l[5]-57434055|0,i=(i<<21|i>>>11)+c|0,o+=(c^(i|~a))+l[12]+1700485571|0,o=(o<<6|o>>>26)+i|0,a+=(i^(o|~c))+l[3]-1894986606|0,a=(a<<10|a>>>22)+o|0,c+=(o^(a|~i))+l[10]-1051523|0,c=(c<<15|c>>>17)+a|0,i+=(a^(c|~o))+l[1]-2054922799|0,i=(i<<21|i>>>11)+c|0,o+=(c^(i|~a))+l[8]+1873313359|0,o=(o<<6|o>>>26)+i|0,a+=(i^(o|~c))+l[15]-30611744|0,a=(a<<10|a>>>22)+o|0,c+=(o^(a|~i))+l[6]-1560198380|0,c=(c<<15|c>>>17)+a|0,i+=(a^(c|~o))+l[13]+1309151649|0,i=(i<<21|i>>>11)+c|0,o+=(c^(i|~a))+l[4]-145523070|0,o=(o<<6|o>>>26)+i|0,a+=(i^(o|~c))+l[11]-1120210379|0,a=(a<<10|a>>>22)+o|0,c+=(o^(a|~i))+l[2]+718787259|0,c=(c<<15|c>>>17)+a|0,i+=(a^(c|~o))+l[9]-343485551|0,i=(i<<21|i>>>11)+c|0,f[0]=o+f[0]|0,f[1]=i+f[1]|0,f[2]=c+f[2]|0,f[3]=a+f[3]|0}function u(f){var l=[],o;for(o=0;o<64;o+=4)l[o>>2]=f.charCodeAt(o)+(f.charCodeAt(o+1)<<8)+(f.charCodeAt(o+2)<<16)+(f.charCodeAt(o+3)<<24);return l}function h(f){var l=[],o;for(o=0;o<64;o+=4)l[o>>2]=f[o]+(f[o+1]<<8)+(f[o+2]<<16)+(f[o+3]<<24);return l}function d(f){var l=f.length,o=[1732584193,-271733879,-1732584194,271733878],i,c,a,E,O,U;for(i=64;i<=l;i+=64)s(o,u(f.substring(i-64,i)));for(f=f.substring(i-64),c=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<c;i+=1)a[i>>2]|=f.charCodeAt(i)<<(i%4<<3);if(a[i>>2]|=128<<(i%4<<3),i>55)for(s(o,a),i=0;i<16;i+=1)a[i]=0;return E=l*8,E=E.toString(16).match(/(.*?)(.{0,8})$/),O=parseInt(E[2],16),U=parseInt(E[1],16)||0,a[14]=O,a[15]=U,s(o,a),o}function p(f){var l=f.length,o=[1732584193,-271733879,-1732584194,271733878],i,c,a,E,O,U;for(i=64;i<=l;i+=64)s(o,h(f.subarray(i-64,i)));for(f=i-64<l?f.subarray(i-64):new Uint8Array(0),c=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<c;i+=1)a[i>>2]|=f[i]<<(i%4<<3);if(a[i>>2]|=128<<(i%4<<3),i>55)for(s(o,a),i=0;i<16;i+=1)a[i]=0;return E=l*8,E=E.toString(16).match(/(.*?)(.{0,8})$/),O=parseInt(E[2],16),U=parseInt(E[1],16)||0,a[14]=O,a[15]=U,s(o,a),o}function m(f){var l="",o;for(o=0;o<4;o+=1)l+=e[f>>o*8+4&15]+e[f>>o*8&15];return l}function _(f){var l;for(l=0;l<f.length;l+=1)f[l]=m(f[l]);return f.join("")}_(d("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(r=function(f,l){var o=(f&65535)+(l&65535),i=(f>>16)+(l>>16)+(o>>16);return i<<16|o&65535}),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function f(l,o){return l=l|0||0,l<0?Math.max(l+o,0):Math.min(l,o)}ArrayBuffer.prototype.slice=function(l,o){var i=this.byteLength,c=f(l,i),a=i,E,O,U,st;return o!==t&&(a=f(o,i)),c>a?new ArrayBuffer(0):(E=a-c,O=new ArrayBuffer(E),U=new Uint8Array(O),st=new Uint8Array(this,c,E),U.set(st),O)}}();function y(f){return/[\\u0080-\\uFFFF]/.test(f)&&(f=unescape(encodeURIComponent(f))),f}function S(f,l){var o=f.length,i=new ArrayBuffer(o),c=new Uint8Array(i),a;for(a=0;a<o;a+=1)c[a]=f.charCodeAt(a);return l?c:i}function T(f){return String.fromCharCode.apply(null,new Uint8Array(f))}function A(f,l,o){var i=new Uint8Array(f.byteLength+l.byteLength);return i.set(new Uint8Array(f)),i.set(new Uint8Array(l),f.byteLength),o?i:i.buffer}function N(f){var l=[],o=f.length,i;for(i=0;i<o-1;i+=2)l.push(parseInt(f.substr(i,2),16));return String.fromCharCode.apply(String,l)}function w(){this.reset()}return w.prototype.append=function(f){return this.appendBinary(y(f)),this},w.prototype.appendBinary=function(f){this._buff+=f,this._length+=f.length;var l=this._buff.length,o;for(o=64;o<=l;o+=64)s(this._hash,u(this._buff.substring(o-64,o)));return this._buff=this._buff.substring(o-64),this},w.prototype.end=function(f){var l=this._buff,o=l.length,i,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;for(i=0;i<o;i+=1)c[i>>2]|=l.charCodeAt(i)<<(i%4<<3);return this._finish(c,o),a=_(this._hash),f&&(a=N(a)),this.reset(),a},w.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},w.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},w.prototype.setState=function(f){return this._buff=f.buff,this._length=f.length,this._hash=f.hash,this},w.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},w.prototype._finish=function(f,l){var o=l,i,c,a;if(f[o>>2]|=128<<(o%4<<3),o>55)for(s(this._hash,f),o=0;o<16;o+=1)f[o]=0;i=this._length*8,i=i.toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(i[2],16),a=parseInt(i[1],16)||0,f[14]=c,f[15]=a,s(this._hash,f)},w.hash=function(f,l){return w.hashBinary(y(f),l)},w.hashBinary=function(f,l){var o=d(f),i=_(o);return l?N(i):i},w.ArrayBuffer=function(){this.reset()},w.ArrayBuffer.prototype.append=function(f){var l=A(this._buff.buffer,f,!0),o=l.length,i;for(this._length+=f.byteLength,i=64;i<=o;i+=64)s(this._hash,h(l.subarray(i-64,i)));return this._buff=i-64<o?new Uint8Array(l.buffer.slice(i-64)):new Uint8Array(0),this},w.ArrayBuffer.prototype.end=function(f){var l=this._buff,o=l.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c,a;for(c=0;c<o;c+=1)i[c>>2]|=l[c]<<(c%4<<3);return this._finish(i,o),a=_(this._hash),f&&(a=N(a)),this.reset(),a},w.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},w.ArrayBuffer.prototype.getState=function(){var f=w.prototype.getState.call(this);return f.buff=T(f.buff),f},w.ArrayBuffer.prototype.setState=function(f){return f.buff=S(f.buff,!0),w.prototype.setState.call(this,f)},w.ArrayBuffer.prototype.destroy=w.prototype.destroy,w.ArrayBuffer.prototype._finish=w.prototype._finish,w.ArrayBuffer.hash=function(f,l){var o=p(new Uint8Array(f)),i=_(o);return l?N(i):i},w})});var K=class{constructor(r,e){this.operation=r;this.data=e}nonce=K.NONCE;static fromObject(r){return!r||r.nonce!==K.NONCE?null:new K(r.operation,r.data)}validate(){return this.nonce===K.NONCE}},M=K;v(M,"NONCE","z3ZCw_12v");var ct=class{crawlId;installId;zys;dateCrawled;crawlUrl;youTubeChannelId;youTubeChannelName;youTubeVideoId;constructor(r,e,n,s,u,h){this.crawlId=r,this.installId=e,this.zys=n,this.dateCrawled=s,this.crawlUrl=u,Object.assign(this,h)}get ads(){return this.zys}set ads(r){this.zys=r}};var _t=_e(Lt(),1);var I=class{x;y;width;height;text;sourceUrls;hash;hashOverride;type;typeOverride;canvases;svgs;depth;adRuleId;dedupeKey;duration;language;youTubeId;facebookData;netflixData;twitterData;vastData;outerHtml;constructor(r){this.x=r.x??0,this.y=r.y??0,this.width=r.width,this.height=r.height,this.text=r.text??"",this.sourceUrls=r.sourceUrls??[],this.hash=r.hash??"",this.type=r.type,this.canvases=[],this.svgs=[],this.depth=0,this.adRuleId=r.adRuleId,this.duration=r.duration,this.language=r.language,this.youTubeId=r.youTubeId,this.facebookData=r.facebookData,this.netflixData=r.netflixData,this.twitterData=r.twitterData,this.vastData=r.vastData}};var Ht=class{u;t;d;width;height;constructor(r){this.u=Ht.qualifyURL(r.url),this.t=r.urlType,this.d=r.depth,this.width=r.width,this.height=r.height}get url(){return this.u}set url(r){this.u=r}get urlType(){return this.t}set urlType(r){this.t=r}get depth(){return this.d}set depth(r){this.d=r}static qualifyURL(r,e){if(!r||new RegExp("^(?:\\\\w+-extension)|(?:about)|(?:blob):").test(r))return"";e=e||document;let n=e.createElement("a");return n.href=r,n.href}},x=Ht;v(x,"SourceUrlTags",new Set(["A","DIV","IFRAME","IMG","LINK","SCRIPT","SPAN","VIDEO"]));async function et(t,r){let e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,u=>x.SourceUrlTags.has(u.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),n=[],s=e.currentNode;for(;s;)n.push(...await _r(s,r)),s=e.nextNode();return n.filter(u=>u.url)}async function _r(t,r){if(!t||!x.SourceUrlTags.has(t.nodeName))return[];if(t.nodeName=="IMG")return[await ve(t,r)];if(t.nodeName=="DIV"||t.nodeName=="SPAN"){let s=/url\\(['"]?([^'"]+)['"]?\\)/gi,u=getComputedStyle(t).getPropertyValue("background-image");return Promise.all(Array.from(u.matchAll(s)).filter(h=>h).map(h=>h[1]).map(async h=>{try{let d=new Image;return d.src=h,await d.decode(),ve(d,r)}catch{return new x({url:h,urlType:7,depth:r})}}))}if(t.nodeName==="VIDEO"){if(t=t.hasAttribute("src")?t:t.querySelector("source"),!t)return[];let s=t.getBoundingClientRect(),u=Math.round(s.width),h=Math.round(s.height);return[new x({url:t.getAttribute("src"),urlType:4,depth:r,width:u,height:h})]}if(t.nodeName==="IFRAME")return[new x({url:t.getAttribute("src"),urlType:1,depth:r,width:t.offsetWidth,height:t.offsetHeight})];let e=null,n=0;switch(t.nodeName){case"SCRIPT":e=t.getAttribute("src"),n=6;break;case"LINK":e=t.getAttribute("href"),n=6;break;case"A":e=t.getAttribute("href"),n=8;break}return[new x({url:e,urlType:n,depth:r})]}async function ve(t,r){let e=t.getAttribute("src"),n=t.getBoundingClientRect(),s=Math.round(t.naturalWidth||n.width),u=Math.round(t.naturalHeight||n.height);if(!(s||u)&&e)try{let d=new Image;d.src=e,await d.decode(),s=d.naturalWidth,u=d.naturalHeight}catch{}let h=0;return(n.width||s)<2&&(n.height||u)<2||s===43&&u===22||n.y+window.scrollY<5&&(n.width||s)<85&&(n.height||u)<=20?h=7:h=3,new x({url:e,urlType:h,depth:r,width:n.width||s,height:n.height||u})}async function At(t,r){var n,s,u;let e=t.sourceUrls.filter(h=>h.t===3||h.t===4);if(t.type=t.typeOverride??(e.length===1&&(e[0].width||0)>=t.width-2&&(((n=e[0])==null?void 0:n.height)||0)>=t.height-2?e[0].t===3?1:3:7),t.hashOverride)return t.hash=t.hashOverride;if(t.hash=(await Promise.all(e.map(async h=>await rt(h.u||"",r)))).filter(h=>h).reduce((h,d)=>ut(h,d),"")||"",t.type===3&&!t.hash&&(t.hash=Q(e[0].u??"",!0)),t.type===7&&t.text){let h=Q(t.text.toLowerCase(),!0);t.hash=ut(t.hash,h)}if(t.hash||((s=t.canvases)!=null&&s.length&&(t.hash=t.canvases.reduce((h,d)=>ut(Q(d),h),t.hash)),(u=t.svgs)!=null&&u.length&&(t.hash=t.svgs.reduce((h,d)=>ut(Q(d),h),t.hash))),t.type===7&&t.hash){let h=Q(br(Se(Math.round(t.height)),Se(Math.round(t.width))),!0);t.hash=ut(t.hash,h)}t.hash=btoa(t.hash)}async function rt(t,r){try{return Q(await r(t))}catch(e){return C(e),""}}function Q(t,r){if(Ar(t)==="arraybuffer"){let e=t;return e.byteLength===0?"":_t.default.ArrayBuffer.hash(e,!0)}else{let e=t;return r?_t.default.hash(e,!0):_t.default.hashBinary(e,!0)}}function Ar(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}function ut(t,r){if(!r)return t||"";if(!t)return r;if(t.length<r.length){let u=t;t=r,r=u}let e=t.length,n=r.length,s="";for(let u=0;u<n;u++)s+=String.fromCharCode(t.charCodeAt(u)^r.charCodeAt(u));for(let u=n;u<e;u++)s+=String.fromCharCode(t.charCodeAt(u));return s}function Se(t){let r=new ArrayBuffer(4);return new DataView(r).setUint32(0,t,!0),r}function br(t,r){let e=new Uint8Array(t.byteLength+r.byteLength);return e.set(new Uint8Array(t),0),e.set(new Uint8Array(r),t.byteLength),e.buffer}var G=3e3;var kt="pc",Vt="ca",lt=null;function C(...t){!lt||(t=t||[],t=t.map(r=>(r==null?void 0:r.stack)&&r.message?{error:r.message,stack:r.stack}:r),t=t.map(r=>typeof r!="object"||r instanceof String?r:JSON.stringify(r)),t.length==1?lt(t[0]):lt(t))}function Te(t){lt=t||lt}var bt=class{constructor(r,e,n,s){let u=Pe(r);u==="object"?(this.left=0,Object.assign(this,r)):u==="number"&&(this.left=Math.round(Math.max(r||0,0))||0,this.top=Math.round(Math.max(e||0,0))||0,this.width=Math.round(Math.max(n||0,0))||0,this.height=Math.round(Math.max(s||0,0))||0)}get bottom(){return this.top+this.height}get right(){return this.left+this.width}toString(){return\`\${this.width}x\${this.height}@\${this.left},\${this.top}\`}},Ne=new RegExp("^(?:https?://)?[a-z0-9.-]+(.[a-z]+)+(?:$|/)","i");function xr(){return([1e7]+-1e3+-1e3+-1e3+-1e11).replace(/[01]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}function Pe(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}function vr(t,r){var s;let e={},n=Object.keys(r);for(let u=0,h=n.length;u<h;u++){let d=n[u];if(r.hasOwnProperty(d)){let p=r[d];if(p==null||p===""&&t[d]||p instanceof Array&&!p.length&&((s=t[d])==null?void 0:s.length)||(d==="top"||d==="left"||d==="X"||d==="Y")&&t[d]>0)continue;e[d]=r[d]}}return Object.assign(t,r)}function b(t){try{return t()}catch{return null}}var Rn=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").map(t=>t.charCodeAt(0));function Re(t){var r,e;return((e=(r=t.tagName)==null?void 0:r.toUpperCase)==null?void 0:e.call(r))||b(()=>t.outerHTML.substr(1,t.outerHTML.indexOf(" ")-1).toUpperCase())||""}function Ee(t){let r=0,e="",n={" ":1,"\\f":1,"\\n":1,"\\r":1,"	":1,"\\v":1,"\\xA0":1,"\\u2028":1,"\\u2029":1};for(let s=0,u=t.length;s<u;s++)n[t.charAt(s)]?(r||(e+=" "),r=1):(r=0,e+=t.charAt(s));return e.trim()}function q(){return Sr(P.location.hostname)}function Sr(t){return t.split(".").slice(t.endsWith(".uk")||t.endsWith(".jp")?-3:-2).join(".")}function Et(){let t=new Set(["aarp.org","abc.com","aol.com","attn.com","atttvnow.com","brainly.com","bravotv.com","cartoonnetwork.com","cbs.com","cbssports.com","chron.com","citationmachine.net","cnet.com","cnn.com","crunchyroll.com","dailymail.co.uk","delish.com","discoveryplus.com","easybib.com","espn.com","facebook.com/watch","fandom.com","foxbusiness.com","foxnews.com","fubo.tv","genius.com","go.cnn.com","go.com","goodhousekeeping.com","happykids.tv","hulu.com","imdb.com","investigationdiscovery.com","linkedin.com","locast.org","mlb.com","msn.com","music.amazon.com","music.apple.com","music.youtube.com","mytuner-radio.com","nexusmods.com","nfl.com","nhl.com","nypost.com","nytimes.com","paramountplus.com","pch.com","philo.com","playstation.com","pluto.tv","rawstory.com","realtor.com","refinery29.com","seattlepi.com","sfgate.com","sling.com","spanishdict.com","sporcle.com","steampowered.com","tablotv.com","therokuchannel.roku.com","try.frndlytv.com","tubitv.com","tv.apple.com","tv.youtube.com","twitch.tv","uproxx.com","usatoday.com","vudu.com","washingtonpost.com","watch.hgtv.com","watch.spectrum.net","weather.com","www3.nhk.or.jp","xbox.com","xfinity.com","yahoo.com","yelp.com","youtube.com","youtubekids.com"]);return F&&(t.has(P.location.hostname)||t.has(q()))}function D(t){t.documentElement&&(t=t.documentElement);let r=Re(t);if(t.offsetParent===null&&r!=="BODY"&&r!=="HTML"&&r!=="FRAME")return new bt;let n=(t.ownerDocument||document).defaultView||P,s=t.getBoundingClientRect();return new bt(s.left+n.scrollX,s.top+n.scrollY,s.width,s.height)}var Ce=["background-image","display","visibility","z-index","border-top-width","border-left-width","border-bottom-width","border-right-width","padding-top","padding-left","padding-bottom","padding-right","position","width","height","top","bottom","left","right","font-size"];function Er(t){var n;if(t._pm_st)return t.style&&(t._pm_st=vr(t._pm_st,JSON.parse(JSON.stringify(t.style,Ce)))),t._pm_st;let r=(n=t.ownerDocument)==null?void 0:n.defaultView;typeof window<"u"&&(!r||!r.opener)&&(r=window);let e=JSON.parse(JSON.stringify(r.getComputedStyle(t),Ce));return t._pm_st=e,e}function Fe(t,r){let e=t.nodeName,n=Er(t),s=D(t);if((n==null?void 0:n.display)!=="none"&&s&&s.width>20&&s.height>20)if(e==="CANVAS"&&!t.matches(".__pm_marker"))try{r.canvases.push(t.toDataURL("image/jpeg",.2))}catch{}else e==="SVG"&&r.svgs.push(t.outerHTML)}function nt(t){if(!t)return"";let r=(t==null?void 0:t.ownerDocument)||document,e=r.defaultView.NodeFilter;if(Pe(t)==="htmldocument"&&t.body&&(t=t.body),!t)return"";let n={SCRIPT:1,NOSCRIPT:1,STYLE:1},s=Re(t);if(s==="HTML"&&(t=t.querySelector("body")),!t)return"";let u=function(p){try{return p.nodeType===3?e.FILTER_ACCEPT:!p.tagName||n[p.tagName]||p.offsetParent===null?e.FILTER_REJECT:e.FILTER_ACCEPT}catch{return e.FILTER_REJECT}};if(t.nodeType!==3&&(!s||n[s]))return"";let h=r.createTreeWalker(t,e.SHOW_ELEMENT|e.SHOW_TEXT,{acceptNode:u},!0),d=[];for(;t;){if(t.nodeType===3){let p=Ee(t.nodeValue||"");d.push(p)}t=h.nextNode()}return d.length?Ee(d.join(" ")):""}function H(t,r){return P.requestIdleCallback?{id:P.requestIdleCallback(t,{timeout:r}),isIdleCallback:!0}:{id:setTimeout(t,r),isIdleCallback:!1}}var xt=null;function it(t){xt=t||xt}function Me(){if(typeof window>"u")return;let t=function(d,p,m,_){H(()=>{!xt||!d||xt(d,p,m,_)},1e4)},r=d=>new TextDecoder("utf-8").decode(new Uint8Array(d)),e=function(d,p){try{if(p=d.currentTarget||p,p=p._datadog_xhr||p,p.readyState===4&&p.status>=200&&p.status<=210){let m=b(()=>p.responseXML),_=b(()=>p.responseText)||b(()=>r(p.response))||b(()=>m.documentElement.outerHTML);(_||m)&&t(_,m,p.reponseType==="json",p.responseURL)}}catch{}},n=XMLHttpRequest.prototype.send;function s(){let d=this.onreadystatechange,p=arguments;this.onreadystatechange=function(m){var _;return e(m,this),(_=d==null?void 0:d.apply)==null?void 0:_.call(d,this,arguments)},n.apply(this,p)}XMLHttpRequest.prototype.send=s;let u=P.fetch,h=function(){return u.apply(this,arguments).then(d=>{let p=d.headers.get("Content-Type");if(p&&(p.includes("text")||p.includes("json")||p.includes("xml")||p.includes("javascript"))){let m=d.clone();H(()=>{m.text().then(_=>t(_,null,p.includes("json"),d.url))},5e3)}return d})};P.fetch=h}function qt(t){if(!t)return null;let r=null;return t=(t+"").trim(),t=="start"?r=0:t.indexOf(":")>=0?r=b(()=>Math.round(t.split(":").reduce((e,n,s,u)=>e+parseFloat(n)*Math.pow(60,u.length-s-1),0)))||r:isNaN(t)||(r=Math.round(parseFloat(t))),r}var Oe,Bt,ht,vt,St;function Ue(t){var r;((r=ht[t.dedupeKey])==null?void 0:r.depth)>t.depth||(ht[t.dedupeKey]=t)}function Cr(){let t=P.location;return t.href.indexOf("youtube.com/watch")===-1?t.origin+t.pathname:t.href}async function Ir(t){await Promise.all(t.map(r=>At(r,B)))}async function Tr(){var e;let t=Object.values(ht),r=Object.values(vt);return ht={},vt={},await Ir(t),new ct(Oe,It,t.concat(r).filter(n=>n.hash),Date.now()-(((e=X)==null?void 0:e.TimeOffset)||0),Bt,St)}function R(t,r){if(!F){J(top,new M(kt,[t,r]));return}t.forEach(e=>vt[e.hash]=e),St=r||St,$()}var Ie=0;async function $(){var r;let t=Date.now();if(t-Ie>G){Ie=t;let e=await Tr();(r=Wt)==null||r(JSON.stringify(e))}}function De(){var r;if(!F)return;Oe=xr();let t=(r=X)==null?void 0:r.ParsedSiteConfigs[q()];if(t){let e=new RegExp(t).exec(location.href);Bt=e?e.slice(1).join(""):location.protocol+"://"+location.hostname}else Bt=Cr();ht={},vt={},St=void 0}function Nr(t,r){return t.reduce(function(e,n){return(e[r(n)]=e[r(n)]||[]).push(n),e},{})}function Ct(t,r){return Object.values(Nr(t,r)).map(e=>e[0])}function J(t,r){t.postMessage(r,"*")}var W=[];async function Le(){C("FACEBOOK AD CAPTURE"),it((t,r,e,n)=>{var s;try{if(!n||!n.includes("/api/graphql"))return;let u=t.split(\`
\`),h=[];for(let d=0,p=u.length;d<p;d++)try{let m=JSON.parse(u[d]),_=null,y=null,S=null,T=null,A=null,N=null;if(((s=m==null?void 0:m.data)==null?void 0:s.category)==="SPONSORED"){let w=m.data.node;w!=null&&w.sponsored_data&&(_=b(()=>w.sponsored_data.ad_id)||b(()=>w.comet_sections.content.story.sponsored_data.ad_id),y=b(()=>w.post_id)||b(()=>w.comet_sections.feedback.story.feedback_context.feedback_target_with_context.ufi_renderer.feedback.comet_ufi_summary_and_actions_renderer.feedback.subscription_target_id),S=b(()=>m.data.node.comet_sections.content.story.wwwURL)||b(()=>m.o.data.node.comet_sections.feedback.story.url)||b(()=>m.data.node.comet_sections.feedback.story.feedback_context.feedback_target_with_context.ufi_renderer.feedback.url),A=b(()=>m.o.data.node.comet_sections.feedback.story.feedback_context.feedback_target_with_context.ufi_renderer.feedback.owning_profile.id)||b(()=>m.data.node.comet_sections.content.story.actors[0].id),N=b(()=>m.data.node.comet_sections.content.story.comet_sections.message.story.message.ranges[0].entity.web_link.url)||b(()=>m.data.node.comet_sections.content.story.comet_sections.message.story.message.ranges[0].entity.external_url)||b(()=>m.data.node.comet_sections.content.story.comet_sections.message.story.message.ranges[0].entity.url))}y&&h.push({id:y,url:S,page_id:A,lp:N,ad_id:_})}catch{}W=W.concat(h)}catch{}}),await Pr()}async function Pr(){if(!z||!W||!W.length)return;let t="div[role='article']",r=Array.from(document.querySelectorAll(t));W=Ct(W,n=>n.id);let e=[];for(let n=0,s=r.length;n<s;n++){let u=r[n],h=null,d=Array.from(u.querySelectorAll("a")).map(w=>w.href);for(let w=0,f=d.length;w<f;w++){let l=d[w];for(let o=0,i=W.length;o<i;o++){let c=W[o];if(l&&c.tracker&&l.includes(c.tracker)){h=c,W.splice(o,1);break}}if(h)break}if(!h)continue;let p=D(u),m=u.querySelector("a span"),_,y=(m==null?void 0:m.textContent)||m&&(_=m.closest("a"))&&(_==null?void 0:_.href.match(/facebook\\.com\\/([^/]+)/)[1]),S=u.querySelector("div[data-ad-preview='message']"),T=nt(S),A=b(()=>{var w;return h.id||((w=h.url)==null?void 0:w.match(/\\/(\\d{7,})\\/?(?:\\?.*)?$/)[1])||btoa(SparkMD5.hash(h.url,!0))});if(!A)continue;let N=new I({x:p.left,y:p.top,width:p.width,height:p.height,text:T,sourceUrls:[new x({url:h.lp,urlType:8})].concat(await et(u)),hash:A,type:u.querySelector("video")?105:Array.from(u.querySelectorAll("img")).filter(w=>w.naturalWidth>200&&w.naturalHeight>40).length?104:102,facebookData:{id:h.id,adid:h.ad_id,u:h.url,an:y,un:b(()=>new URL(h.url).pathname.split("/",2)[1]),pid:h.page_id}});N.sourceUrls=(N.sourceUrls||[]).filter(w=>(w==null?void 0:w.url)&&w.urlType!=3).slice(0,5),e.push(N)}R(e)}var He=null;function Be(){let t=document.querySelector("video.ad-video-player,video#ad-video-player"),r=document.querySelector(".AdUnitView a"),e=t&&t.src;if(t&&r&&e&&He!==e&&e.endsWith(".mp4")&&e.indexOf("bumper")===-1&&(e.indexOf("ads")>=0||e.indexOf("Ads")>=0)){if(!t.duration||isNaN(t.duration))return;He=e,H(()=>{rt(e,B).then(n=>R([new I({width:1920,height:1080,sourceUrls:[new x({url:e,urlType:4}),new x({url:r.href,urlType:8})],hash:btoa(n),type:3,duration:Math.round(t.duration)})]))});return}}var Tt={},ke=!1;function Ve(){if(C("NETFLIX AD CAPTURE"),!(typeof window>"u")){if(!ke){let t=Object.defineProperty;Object.defineProperty=function(e,n,s){return H(()=>{if(Object.hasOwn(e,"isAd")&&e.isAd){let u=Rr(e);u&&(Tt[u.hash]=u)}}),t(e,n,s)},ke=!0}R(Object.values(Tt)),Tt={}}}function Rr(t){let r=t.movieId;if(!r||Tt[r])return;let e=t.video_tracks[0].streams[0],n=e.res_w,s=e.res_h,u=t.audio_tracks[0].streams[0];return new I({hash:("n+++"+r).padEnd(r.length+4+(r.length+4)*6%8/2,"=").replace("===","A=="),type:3,sourceUrls:[new x({url:e.urls[0].url,urlType:4,width:n,height:s}),new x({url:u.urls[0].url,urlType:9})],width:n,height:s,duration:t.duration,language:u.language,netflixData:{id:r}})}var ft=[];async function qe(){C("TWITTER AD CAPTURE"),it((t,r,e,n)=>{try{if(!n||!n.includes("HomeTimeline")&&!(n.includes("/conversation/")&&n.includes("/"+/\\d+$/.exec(window.location.pathname)[0]+".json")))return;let s=Fr(t);ft=ft.concat(s)}catch{}}),await Mr()}function Fr(t){var s,u,h,d,p,m,_;let r=JSON.parse(t);return([].concat.apply([],(_=(m=(p=(d=(h=(u=(s=r==null?void 0:r.data)==null?void 0:s.home)==null?void 0:u.home_timeline_urt)==null?void 0:h.instructions)==null?void 0:d.filter)==null?void 0:p.call(d,y=>(y==null?void 0:y.type)=="TimelineAddEntries"))==null?void 0:m.map)==null?void 0:_.call(m,y=>y.entries))||[]).map(y=>{var S;return(S=y.content)==null?void 0:S.itemContent}).filter(y=>y==null?void 0:y.promotedMetadata).map(y=>{var A,N,w,f,l,o,i,c,a,E,O,U,st,ee,re,ne,ie,oe,se,ae,ce,ue,le,he,fe,de,pe,me,ge,ye;let S=(a=(c=(i=(o=(l=(f=(w=(N=(A=y.tweet_results)==null?void 0:A.result)==null?void 0:N.card)==null?void 0:w.legacy)==null?void 0:f.binding_values)==null?void 0:l.filter)==null?void 0:o.call(l,at=>(at==null?void 0:at.key)=="unified_card"))==null?void 0:i.map)==null?void 0:c.call(i,at=>{var we;return JSON.parse((we=at.value)==null?void 0:we.string_value)}))==null?void 0:a[0],T=((st=(U=(O=(E=S==null?void 0:S.destination_objects)==null?void 0:E.browser_1)==null?void 0:O.data)==null?void 0:U.url_data)==null?void 0:st.url)||((ne=(re=(ee=S==null?void 0:S.destination_objects)==null?void 0:ee.browser_with_docked_media_1)==null?void 0:re.url_data)==null?void 0:ne.url);return{id_str:(oe=(ie=y==null?void 0:y.tweet_results)==null?void 0:ie.result)==null?void 0:oe.rest_id,screen_name:(he=(le=(ue=(ce=(ae=(se=y==null?void 0:y.tweet_results)==null?void 0:se.result)==null?void 0:ae.core)==null?void 0:ce.user_results)==null?void 0:ue.result)==null?void 0:le.legacy)==null?void 0:he.screen_name,cardDestination:T,advertiserId:(pe=(de=(fe=y==null?void 0:y.promotedMetadata)==null?void 0:fe.advertiser_results)==null?void 0:de.result)==null?void 0:pe.rest_id,user_id_str:(ye=(ge=(me=y==null?void 0:y.tweet_results)==null?void 0:me.result)==null?void 0:ge.legacy)==null?void 0:ye.user_id_str}}).filter(y=>y.id_str&&y.screen_name)}async function Mr(){if(!z)return;let t=await Or(document,ft),r=t.map(e=>e.twitterData.tid);ft=ft.filter(e=>!r.includes(e.id_str)),R(t)}async function Or(t,r){let e="div.tweet.promoted-tweet",n=Array.from(t.querySelectorAll(e));n.length||(n=Array.from(t.querySelectorAll("article div>svg")).map(u=>u.parentElement.querySelector("span")).filter(u=>(u==null?void 0:u.textContent)&&u.textContent.length<50).map(u=>u.closest("article")));let s=[];for(let u=0;u<n.length;u++){let h=n[u],d=Array.from(h.querySelectorAll("div>span,a span")).map(A=>A.textContent).filter(A=>A==null?void 0:A.startsWith("@"))[0];d=d.startsWith("@")?d.substring(1):d;let p=null,m=null;for(m of r)if(m.screen_name==d&&(p=m.id_str,p))break;if(!p)continue;let _=nt(h);_&&(_=_.replace(new RegExp("# (\\\\w)","gi"),"#$1"));let y=D(h),S=new I({x:y.left,y:y.top,width:y.width,height:y.height,text:_,sourceUrls:(await et(h.querySelector(".tweet-details-fixer")||h)).concat([new x({url:m.cardDestination,urlType:8})]).filter(A=>A.url&&!A.url.includes("/profile_images/")&&!A.url.includes(p+"/retweets")&&!A.url.includes(p+"/likes")&&!A.url.includes("/using-twitter/how-to")),hash:("t+++"+p).padEnd(p.length+4+(p.length+4)*6%8/2,"=").replace("===","A=="),type:h.querySelector("video")||h.querySelector(".PlayableMedia")?105:Array.from(h.querySelectorAll("img")).filter(A=>A.naturalWidth>200&&A.naturalHeight>40).length?104:h.querySelector("iframe")?102:103,twitterData:{taid:parseInt(m.advertiserId||m.user_id_str||0),tid:parseInt(p),tsn:d}}),T=(S.sourceUrls||[]).filter(A=>A==null?void 0:A.url);S.sourceUrls=Ct(T,A=>A.url),s.push(S)}return s}function jt(){C("VAST AD CAPTURE"),it((t,r,e)=>{try{let n=t.substring(0,500),s=n.indexOf('"ad_id":')>=0||n.indexOf('"ad_type"')>=0,u=[];if(e||s)Ur(t,u);else if(n.indexOf("<VAST ")>=0||n.indexOf("<vmap:AdBreak ")>=0){let h=b(()=>(r==null?void 0:r.documentElement)||t&&new DOMParser().parseFromString(t,"application/xml").documentElement);Dr(h,u)}else return;Promise.allSettled(u).then(h=>{C("Ads found.",h.map(d=>d.value)),R(h.map(d=>d.value).filter(d=>d))})}catch(n){C(n)}})}function Ur(t,r){let e=b,n=e(()=>t&&JSON.parse(t)),s=e(()=>n.items);s!=null&&s.length&&Array.from(s).forEach(u=>{let h=e(()=>u.media.streamurl);if(!h)return;let d=e(()=>u.clickthrough),p=e(()=>u.media.duration),m=e(()=>u.ad_id||u.ad_video_id),_=e(()=>u.title);m&&q()==="peacocktv.com"&&(m=m.split(".")[0]);let y=e(()=>u.system);r.push(rt(h,B).then(S=>new I({width:1920,height:1080,sourceUrls:[new x({url:h,urlType:4}),new x({url:d,urlType:8}),new x({url:"http://"+y,urlType:1})].filter(A=>A.url),hash:btoa(S)||m,type:3,duration:Math.round(p),vastData:{Id:m,Title:_,System:y}})))})}function Dr(t,r){let e=b,n=e(()=>t==null?void 0:t.querySelectorAll("VAST Ad"));n&&Array.from(n).forEach(s=>{let u=s.querySelector("Creatives Creative");if(!u)return;let h=u.querySelector("MediaFiles");if(!h)return;let d=e(()=>u.querySelector("VideoClicks ClickThrough").textContent.trim())||e(()=>document.querySelector(".AdUnitView a").href.trim()),p=e(()=>qt(u.querySelector("Duration").textContent)),m=e(()=>h.querySelector("MediaFile[type='video/mp4'],MediaFile[type='application/dash+xml'],MediaFile[type='video/mpd']").textContent.trim());if(!m){let l=u.querySelector("AdParameters"),o={},i,c=new RegExp("<(\\\\w+)>([^<]+)</\\\\1>","gi");for(;(i=c.exec(l.textContent))!==null;)o[i[1]]=i[2];p=e(()=>qt(o.adDuration)),d=e(()=>o.clickUrl);let a=o.JsParameters;if(!a)return;let E=JSON.parse(a);m=e(()=>E.videos[0].url),m&&(p=p||E.duration,d=d||E.clickThruUrl||E.clickThroughUrl)}if(!m)return;let _=u.getAttribute("AdID")||u.getAttribute("AdId")||u.getAttribute("adid")||s.getAttribute("id");if(!_)return;q()==="peacocktv.com"&&(_=_.split(".")[0]);let y=e(()=>s.querySelector("AdTitle").textContent.trim()),S=e(()=>s.querySelector("AdSystem").textContent.trim()),T=s.querySelector("Extension"),A=e(()=>T.querySelector("CreativeParameter[name='_fw_advertiser_name']").textContent.trim())||e(()=>T.querySelector("CreativeParameter[name='fw_advertiser_name']").textContent.trim())||e(()=>T.querySelector("CreativeParameter[name='fw_advertiser']").textContent.trim()),N=e(()=>T.querySelector("CreativeParameter[name='fw_brand']").textContent.trim()),w=e(()=>T.querySelector("CreativeParameter[name='industry']").textContent.trim()),f=e(()=>T.querySelector("CreativeParameter[name='ccr_measurement']").textContent.trim());r.push(rt(m,B).then(l=>new I({width:1920,height:1080,sourceUrls:[new x({url:m,urlType:4}),new x({url:d,urlType:8}),new x({url:f,urlType:0})].filter(o=>o.url),hash:btoa(l)||_,type:3,duration:Math.round(p),vastData:{Id:_,Adv:A,Brand:N,Cat:w,Title:y,System:S}})))})}var We=_e(Lt(),1);function Lr(t){return t?new URL(t).searchParams.get("v"):null}var Gt;function Nt(){return Gt||(Gt=document.querySelector("#movie_player")),Gt}function Hr(){return b(()=>{let t=JSON.parse(Nt().getDebugText());return t.ad_debug_videoId||t.addebug_videoId||t.ad_videoId})}function Br(){return b(()=>{let t=document.querySelector("#upload-info a.yt-simple-endpoint"),r=t.href.split("/");return{youTubeChannelId:r[r.length-1],youTubeChannelName:t.textContent.trim(),youTubeVideoId:b(()=>Lr(window.location.href))}})}function kr(){let t="",r=new RegExp("\\\\.[a-z]{2,4}$"),e=Array.from(document.querySelectorAll(".ytp-a"+t+"d-button-text")).map(s=>s.textContent).filter(s=>s&&r.test(s))[0];if(e&&Ne.test(e)){let s=e.indexOf("http://")===0||e.indexOf("https://")===0?e:"https://"+e.toLowerCase();return new x({url:s,urlType:8})}let n=document.querySelector("a.ytd-image-companion-renderer[href*='googlead'],a.ytd-action-companion-renderer[href*='googlead']");if(n!=null&&n.href){let s=new x({url,urlType:8});if(s.url)return s}return null}function Vr(t){return t?btoa(We.default.hash("YouTube+"+t,!0)):null}function qr(){return b(()=>Nt().getAdState()>0||JSON.parse(Nt().getDebugText()).addebug_videoId)}function je(){if(!qr())return $();C("YouTube ad capturing detected ad playing.");let t=0,r=640,e=360,n=0,s=0,u=Nt(),h=u.querySelector("a.ytp-title-link"),d=u.querySelector("video");if(d){t=d.duration||0;let p=D(d);r=(p==null?void 0:p.width)||r,e=(p==null?void 0:p.height)||e,n=(p==null?void 0:p.left)||n,s=(p==null?void 0:p.top)||s}H(()=>{let p=kr(),m=Hr()||void 0,_=Br(),y=p?[p]:[],S=new I({x:n,y:s,width:r,height:e,text:h==null?void 0:h.textContent,sourceUrls:y,hash:Vr(m),type:3,duration:Math.round(t),youTubeId:m});R([S],_)})}var g,Xt,Pt,Rt,zt,mt,$t,Y,dt,Yt,Wr,gt,Jt,j,pt=class{constructor(r=null){L(this,j,(g=class{static evaluate(e,n,s){try{if(!this[e.r])throw new Error(e.r+" is not a parser rule function.");return this[e.r](e,n,s)}catch(u){this.log("Error "+e.r+' at "'+this.GetText(e)+'": '+u)}}static PassOn(e,n){return this.evaluate(e.c[0],n)}static NoOp(e){this.log(\`Unimplemented rule: \${e.r} at "\${this.GetText(e.t)}".\`)}static PropName(e){return e.c?e.c[0].t:V(this,mt,$t).call(this,e.t)}static ObjectLit(e,n){let s={};return e.c.forEach(u=>this.PropExpAssign(u,n,s)),s}static PropExpAssign(e,n,s){let u=this.evaluate(e.c[0],n),h=this.evaluate(e.c[1],n);s[u]=h}static StrLit(e){return V(this,mt,$t).call(this,e==null?void 0:e.t)}static NumLit(e){return Number.parseFloat(e==null?void 0:e.t)}static IntLit(e){return Number.parseInt(e==null?void 0:e.t)}static BoolLit(e){return e.t&&e.t=="true"}static NullLit(){return null}static IdExp(e,n){return this.evaluate(e.c[0],n)}static Id(e,n){return n[e.t]}static FuncExp(e,n){return this.evaluate(e.c[0],n)}static ArrowFunc(e,n){var h,d;let s=(d=(h=e.c[0])==null?void 0:h.c)==null?void 0:d.map(p=>V(this,Y,dt).call(this,p)).flat(),u=this;return function(...p){s.forEach((_,y)=>{n[_]=p[y]});let m=u.evaluate(e.c[1],n);return s.forEach(_=>{delete n[_]}),m}}static AnonFuncDecl(e,n){var h,d;let s=(d=(h=e.c[0])==null?void 0:h.c)==null?void 0:d.map(p=>V(this,Y,dt).call(this,p)).flat(),u=this;return function(...p){s.forEach((_,y)=>{n[_]=p[y]});let m=u.evaluate(e.c[1],n);return s.forEach(_=>{delete n[_]}),m}}static GetText(e){return V(this,Y,dt).call(this,e).join(" ")}static ElementList(e,n){return e.c.map(s=>this.evaluate(s,n))}static ArgsExp(e,n){let s=e.c[0],u=this.evaluate(e.c[1],n),h=this.evaluate(s,n,u);return typeof h=="function"&&(h=h.apply(s._this??null,u)),delete s._this,h}static Args(e,n){return e.c.map(s=>this.evaluate(s,n))}static Arg(e,n){return this.evaluate(e.c[0],n)}static MemberDotExp(e,n,s){return V(this,gt,Jt).call(this,e,n,s,!0)}static MemberIndexExp(e,n,s){return V(this,gt,Jt).call(this,e,n,s)}static ErrorNodeImpl(e){this.log(\`Error parsing \${e.r} at \${e.t} (unexpected token?)\`)}static AdditiveExp(e,n){switch(e.c[1].t){case"+":return this.evaluate(e.c[0],n)+this.evaluate(e.c[2],n);case"-":return this.evaluate(e.c[0],n)-this.evaluate(e.c[2],n);default:throw new Error("Unknown binary operator "+e.c[1].t)}}static MultiplicativeExp(e,n){switch(e.c[1].t){case"*":return this.evaluate(e.c[0],n)*this.evaluate(e.c[2],n);case"/":return this.evaluate(e.c[0],n)/this.evaluate(e.c[2],n);case"%":return this.evaluate(e.c[0],n)%this.evaluate(e.c[2],n);default:throw new Error("Unknown binary operator "+e.c[1].t)}}static RelationalExp(e,n){switch(e.c[1].t){case">":return this.evaluate(e.c[0],n)>this.evaluate(e.c[2],n);case"<":return this.evaluate(e.c[0],n)<this.evaluate(e.c[2],n);case">=":return this.evaluate(e.c[0],n)>=this.evaluate(e.c[2],n);case"<=":return this.evaluate(e.c[0],n)<=this.evaluate(e.c[2],n);default:throw new Error("Unknown binary operator "+e.c[1].t)}}static EqualityExp(e,n){switch(e.c[1].t){case"==":return this.evaluate(e.c[0],n)==this.evaluate(e.c[2],n);case"!=":return this.evaluate(e.c[0],n)!=this.evaluate(e.c[2],n);case"===":return this.evaluate(e.c[0],n)===this.evaluate(e.c[2],n);case"!==":return this.evaluate(e.c[0],n)!==this.evaluate(e.c[2],n);default:throw new Error("Unknown binary operator "+e.c[1].t)}}static TernaryExp(e,n){return this.evaluate(e.c[0],n)?this.evaluate(e.c[1],n):this.evaluate(e.c[2],n)}static CoalesceExp(e,n){return this.evaluate(e.c[0],n)??this.evaluate(e.c[1],n)}static InstanceofExp(e,n){return this.evaluate(e.c[0],n)instanceof this.evaluate(e.c[1],n)}static LogicalAndExp(e,n){return this.evaluate(e.c[0],n)&&this.evaluate(e.c[1],n)}static LogicalOrExp(e,n){return this.evaluate(e.c[0],n)||this.evaluate(e.c[1],n)}static UnaryPlusExp(e,n){return+this.evaluate(e.c[0],n)}static UnaryMinusExp(e,n){return-this.evaluate(e.c[0],n)}static BitNotExp(e,n){return~this.evaluate(e.c[0],n)}static NotExp(e,n){return!this.evaluate(e.c[0],n)}static ParenthesizedExp(e,n){return this.evaluate(e.c[0],n)}static Eos(){return null}static _x_query(e,n){return Array.from((e==null?void 0:e.querySelectorAll(n))??[])}static _x_where(e,n){return e==null?void 0:e.filter(n)}static _x_select(e,...n){let s=n.length;if(!n||s===0)throw new Error("Method 'select' expects on or more arrow functions.");return e==null?void 0:e.map((u,h)=>{if(s>1){let d=[];for(let p=0;p<s-1;p++)d[p]=n[p](u,...p==0?[h]:d);return n[s-1](u,...d)}else return n[0](u,h)})}static _x_width(e){return e==null?void 0:e.offsetWidth}static _x_height(e){return e==null?void 0:e.offsetHeight}static _x_text(e){var n,s;return(s=(n=e==null?void 0:e.textContent)==null?void 0:n.trim())==null?void 0:s.replaceAll(k(this,Rt)," ")}static _x_parent(e){return e==null?void 0:e.parentNode}static _x_matchRegExp(e,n,s){return e.match(new RegExp(n,s))}},Xt=new WeakMap,Pt=new WeakMap,Rt=new WeakMap,zt=new WeakMap,mt=new WeakSet,$t=function(e){return e==null?void 0:e.replaceAll(k(this,Pt),"")},Y=new WeakSet,dt=function(e,n=null){var s;return n=n??[],(s=e.c)==null||s.forEach(u=>V(this,Y,dt).call(this,u,n)),e.t&&n.push(e.t),n},Yt=new WeakSet,Wr=function(e,n=0){this.log(\`\${"  ".repeat(n)}\${e.r}: \${this.GetText(e)}\`)},gt=new WeakSet,Jt=function(e,n,s,u){let h=this.evaluate(e.c[0],n),d=u?e.c[1].t:this.evaluate(e.c[1],n);return this["_x_"+d]?this["_x_"+d](h,...s??[]):(e._this=h,h[d])},L(g,mt),L(g,Y),L(g,Yt),L(g,gt),L(g,Xt,0),L(g,Pt,new RegExp(\`(?:^['"])|(?:['"]$)\`,"g")),L(g,Rt,new RegExp("\\\\s+","g")),L(g,zt,g),v(g,"ExpStmt",g.PassOn),v(g,"ExpSequence",g.PassOn),v(g,"LitExp",g.PassOn),v(g,"Literal",g.PassOn),v(g,"ArrayLitExp",g.PassOn),v(g,"ArrayLit",g.PassOn),v(g,"ArrowFuncBody",g.PassOn),v(g,"ObjectLitExp",g.PassOn),v(g,"IdName",g.PassOn),v(g,"MultOperator",g.NoOp),v(g,"AdditionOperator",g.NoOp),v(g,"RelationalOperator",g.NoOp),v(g,"EqualityOperator",g.NoOp),v(g,"ReservedWord",g.NoOp),v(g,"AssignExp",g.NoOp),v(g,"VarModifier",g.NoOp),v(g,"FormalParameterList",g.NoOp),v(g,"FormalParameterArg",g.NoOp),v(g,"PropAssign",g.NoOp),v(g,"Exp",g.NoOp),v(g,"Assignable",g.NoOp),v(g,"AnonFunc",g.NoOp),v(g,"ArrowFuncParameters",g.NoOp),v(g,"ArrayElem",g.PassOn),g));this.log=r,k(this,j).log=r??(()=>{})}simplifyTree(r){let e;for(;;){if(e=k(this,j)[r.r],!e)throw new Error(\`Rule \${r.r} not implemented.\`);if(e!==k(this,j).PassOn||!r.c||!r.c.length)break;r=r.c[0]}return r.c&&r.c.length&&(r.c=r.c.map(n=>this.simplifyTree(n))),r}debugPrintParseTree(r,e=0){this.log(\`\${" ".repeat(e*2)}\${r.r}: \${k(this,j).GetText(r)}\`),r.c&&r.c.length&&r.c.forEach(n=>this.debugPrintParseTree(n,e+1))}isValidRuleName(r){return r.indexOf("TerminalNode")===0||!!k(this,j)[r]}evaluate(r,e){return k(this,j).evaluate(r,e)}};j=new WeakMap;function Ge(t,r){return e=>new Promise(n=>{let s=t+"-response",u=Math.random(),h=p=>{let{type:m,payload:_,nonce:y}=p.data??{};m!==s||y!==u||(n(_),d())},d=()=>{window.removeEventListener("message",h)};window.addEventListener("message",h),s==="getFrameId-response"?e.postMessage(new M("getFrameId",u),"*"):window.postMessage({type:t,nonce:u,payload:e},"*"),r&&setTimeout(n,r)})}var Je,Xe,ze,ot,Mt=new Set,Ot=new Set,Qt=new Set,wt=!1,Zt=[],Ye=[],Wt,B,X,It,z,P=typeof window>"u"?{location:{hostname:""}}:window,F=P.top===P.self,jr=(Math.random()+1).toString(36).substring(2),Gr=2e3,Ke=7e3,$r=5*Ke,Jr=2e3;function Kt(t,r,...e){let n=setTimeout(t,r,...e);return Mt.add(n),n}function yt(t,r,...e){let n=setInterval(t,r,...e);return Ot.add(n),n}function te(t,r){let e=H(t,r);return e.isIdleCallback?Qt.add(e.id):Mt.add(e.id),e}var Xr={"facebook.com":[Le],"hulu.com":[Be],"netflix.com":[Ve],"twitter.com":[qe],"youtube.com":[je]};wt||(typeof q<"u"&&(ot=q()),typeof Et<"u"&&(Et()||Qe())&&Me());function Qe(){return Xr[ot]}function zr(){if(!F||!z)return;if(Et()){jt();let s=new Set,u=()=>{let h=Array.from(P.frames).concat(Array.from(document.querySelectorAll("frame,iframe")).map(d=>b(d.contentWindow)).filter(d=>d));for(let d=0;d<h.length;d++)try{let p=h[d];if(!p||s.has(p))continue;J(p,new M(Vt)),s.add(p)}catch(p){C(p)}};u(),yt(u,5e3)}let t=Date.now(),r=Qe(),e=function(s){t=Date.now(),te(async()=>{for(let u=0,h=r==null?void 0:r.length;r&&u<h;u++)await r[u].call();F&&(r||s)&&$()},G-500)},n=yt(e,G);e(!0),yt(()=>{Date.now()-t>G*5&&(clearInterval(n),Ot.delete(n),n=yt(e,G),e(!0))},G)}function Ze(){!F||(ot=q(),Mt=new Set,Ot=new Set,Qt=new Set,De(),$())}function Yr(){if(!F)return;let t=X.AdRules.filter(n=>!n.Hostnames||n.Hostnames.startsWith("^")&&!n.Hostnames.includes(ot)),r=X.AdRules.filter(n=>n.Hostnames&&!n.Hostnames.startsWith("^")&&n.Hostnames.includes(ot)),e=t.concat(r);Kt(()=>{dn();let n=yt(()=>{$e(e)},Ke);$e(e),Kt(()=>{r.length?e=r:clearInterval(n)},$r)},Gr)}var Kr=new Set(["facebook.com","hulu.com","twitter.com"]);function tr(){zr(),Kr.has(ot)||Yr()}function Qr(t){if(!F)return;let r=P.location.href.split("#")[0];setInterval(()=>{let e=P.location.href.split("#")[0];e!==r&&(r=e,t())},1e3)}function Zr(){Mt.forEach(t=>clearTimeout(t)),Ot.forEach(t=>clearInterval(t)),Qt.forEach(t=>cancelIdleCallback(t)),Ze(),tr()}function tn(t){wt?At(t,B).then(()=>window.dispatchEvent(new CustomEvent("displayAdFound",{detail:t}))):Ue(t)}async function en(t){try{let r=M.fromObject(t.data);if(!r)return;let e=r.data;switch(r.operation){case Vt:jt();break;case kt:R(e[0],e[1]);break;case"extractDisplayAd":F||await Ft(document.documentElement,e);break;case"displayAdFound":F&&tn(e);break;case"getFrameId":J(t.source,{type:"getFrameId-response",payload:jr,nonce:e});break}}catch(r){C(r);return}}function rn(){function t(){P.addEventListener("message",en,!0)}t();let r=setInterval(t,200);setTimeout(clearInterval,1e4,r)}function nn(t){Xe=t.getInstallId,wt=t.isRuleEditor,Wt=t.sendData,B=t.fetchHttpResponse,Je=t.getExternalConfiguration?r=>t.getExternalConfiguration(r):null,Te(t.pm_log)}function er(t){ze=Ge("getFrameId",1e3),B=t.fetchHttpResponse,rn(),F&&(nn(t),Xe().then(r=>It=r).then(r=>Je()).then(r=>X=r||{EnabledPct:0}).then(r=>{z=Array.from(It).map(e=>e.charCodeAt(0)).reduce((e,n)=>e+n,0)%100<X.EnabledPct,z&&(Ze(),tr(),Qr(Zr))}))}async function on(t,r){wt||(F||(r.dedupeKey=await ze(t.ownerDocument.defaultView)),r.dedupeKey??(r.dedupeKey=\`\${r.width}x\${r.height} @ \${r.x},\${r.y}\`)),J(top,new M("displayAdFound",r))}async function sn(t,r){if(t){let e=D(t);(r.isFromIFrame||t.nodeName!=="IFRAME")&&(r.x+=e.left,r.y+=e.top),r.sourceUrls.push(...await et(t,r.depth)),r.text+=nt(t)+" ";let n=Array.from(t.querySelectorAll("canvas, svg"));n.length&&n.forEach(s=>Fe(s,r))}}async function Ft(t,r){if(await sn(t,r),t.nodeName==="IFRAME"){r.depth++,r.outerHtml=t.outerHTML;try{await Ft(t.contentWindow.document.documentElement,r)}catch{J(t.contentWindow,new M("extractDisplayAd",r));try{var e=t.contentWindow.frames;for(let s=0,u=e.length;s<u;s++)try{J(e[s],new M("extractDisplayAd",r))}catch(h){C(h)}}catch(s){C(s)}}}else{t.nodeName==="HTML"&&(r.outerHtml+=\`<!-- IFRAME Content -->\${t.outerHTML}\`);let n;if(r.isFromIFrame){if(t.scrollWidth<=r.width-5||t.scrollHeight<=r.height-5)return;n=Array.from(t.querySelectorAll("iframe")).filter(s=>s.scrollWidth===r.width&&s.scrollHeight===r.height)[0]}else n=Array.from(t.querySelectorAll("iframe")).sort((s,u)=>s.scrollWidth*s.scrollHeight-u.scrollWidth*u.scrollHeight)[0];n?await Ft(n,r):(r.text=r.textOverride??r.text.trim(),on(t,r))}}function an(t,r,e){try{let n=new pt,s=n.evaluate(r,{doc:document});Zt.forEach(u=>s.push(...n.evaluate(r,{doc:u}))),Ye.forEach(u=>{!u.doc.defaultView||s.push(...n.evaluate(r,{doc:u.doc}).map(h=>rr(h)?(h.x??(h.x=u.x),h.y??(h.y=u.y),h):{element:h,x:u.x,y:u.y}))}),s&&s.forEach(async u=>await un(t,u,e))}catch{}}function cn(t){t.forEach(r=>an(r.Id,r.ParseTree))}async function un(t,r,e){let n={};rr(r)&&(n=r,r=r.element,delete n.element);let s=new I({width:r.offsetWidth,height:r.offsetHeight,adRuleId:t});s.isFromIFrame=r.nodeName==="IFRAME",wt&&(s.adRuleName=e,s.tabUrl=location.href),Object.assign(s,n),await Ft(r,s)}function $e(t){!F||te(r=>{r.didTimeout||(cn(t),Kt($,Jr))},4e3)}function ln(t){let r=Date.now(),e=null;for(;e=t[0];){for(var n=null;n=e.nextNode();)if(n.shadowRoot&&(t.push(document.createTreeWalker(n.shadowRoot,NodeFilter.SHOW_ELEMENT)),Zt.push(n.shadowRoot)),Date.now()-r>50)return!1;t.shift()}return!0}function hn(){Zt=[];let t=[document.createTreeWalker(document.body,NodeFilter.SHOW_ELEMENT)],r=!1,e=0;for(;!r&&e++<100;)te(()=>r||(r=ln(t)))}function fn(){Ye=Array.from(document.querySelectorAll("iframe")).filter(t=>t.src&&new URL(t.src).origin==top.location.origin&&t.offsetWidth>=120&&t.offsetHeight>=28).map(t=>{try{let r=t.contentWindow,e=D(t),n=e.left,s=e.top;for(;(r==null?void 0:r.parent)&&r.parent!==top;)r=r.parent,e=D(r.frameElement),n+=e.left,s+=e.top;return{doc:t.contentDocument,x:n,y:s}}catch{return null}}).filter(t=>t)}function dn(){hn(),fn()}function rr(t){return!(t instanceof Node)&&t.element}function nr(...t){console.log("[injected-script]",...Array.isArray(t)?t:[t])}function Ut(t,r){return e=>new Promise(n=>{let s=r+"-response",u=Math.random(),h=p=>{let{type:m,payload:_,nonce:y}=p.data??{};m!==s||y!==u||(t==null||t("Got response:",{name:r,payload:e,response:_}),n(_),d())},d=()=>{window.removeEventListener("message",h)};window.addEventListener("message",h),t==null||t("Sending message:",{name:r,payload:e}),window.postMessage({type:r,payload:e,nonce:u},"*")})}function ir(t,r){return e=>{t==null||t("Sending message:",{type:r,payload:e}),window.postMessage({type:r,payload:e},"*")}}var or="ads#INIT",sr="ads#SEND_DATA",ar="ads#GET_INSTALL_ID",cr="ads#GET_EXTERNAL_CONFIG",ur="ads#FETCH_HTTP_RESPONSE";function lr(t){let r=t.enableLogs?nr:void 0;r==null||r("Recieved init event",{config:t});let e=ir(r,sr),n=Ut(r,ar),s=Ut(r,cr),u=Ut(r,ur);er({getInstallId:n,fetchHttpResponse:u,sendData:e,pm_log:r,getExternalConfiguration:s})}function pn(){window.addEventListener("message",({data:t})=>{(t==null?void 0:t.type)===or&&lr(t.payload)})}pn();})();
`,mv3Path:t.mv3PathmaticsPath,onInjected:this.initPathmaticsScript.bind(this)}),this.messenger=new ce({logger:t.logger,responseSuffix:j.MESSENGER_SUFFIX})}async isSupportedSite(){const t=K(location.hostname);return Z()?!await Y(this.config.sendMessageToBackground).then(r=>{return null==(r=null==(r=r.ParsedUrlBlackList)?void 0:r[t])?void 0:r.some(h=>new RegExp(h).test(location.href))}):!(location.hostname===j.GOOGLE_AUTH_HOSTNAME||j.SUBFRAME_DOMAIN_BLOCKLIST.has(t))}async start(){var h,u,n;if(document.documentElement){var t=await this.isSupportedSite();if(null!=(n=this.config.logger)&&n.log("Is supported site?",t),t)try{null!=(h=this.config.logger)&&h.log("Starting Pathmatics ad-finder...",{url:window.location.href}),this.setupMessageListeners(),await this.injector.inject("script"),null!=(u=this.config.logger)&&u.log("Pathmatics ad-finder injected!")}catch(p){null!=(n=this.config.logger)&&n.error("Failed to start Pathmatics ad-finder",p)}else null!=(t=this.config.logger)&&t.log("Not supported site, stopping pathmatics",window.location.hostname)}else null!=(h=this.config.logger)&&h.log("Page is blank, stopping pathmatics",window.location.hostname)}setupMessageListeners(){if(null==D.storage)throw Error("The storage permission is required for pathmatics' ad-finder");this.messenger.onMessage("ads#FETCH_HTTP_RESPONSE",async t=>{t=await function(t){if(!t)return Promise.resolve(new ArrayBuffer(0));try{return fetch("data:application/octet-binary;base64,"+t).then(n=>n.arrayBuffer(),()=>new ArrayBuffer(0))}catch{return Promise.resolve(new ArrayBuffer(0))}}(await this.config.sendMessageToBackground({type:U.FETCH_HTTP_RESPONSE,payload:t}));return{response:t,transferables:[t]}}),Z()&&(this.messenger.onMessage("ads#GET_INSTALL_ID",async()=>({response:await this.config.getInstallId()})),this.messenger.onMessage("ads#SEND_DATA",async t=>{var p,o,y,u,t=JSON.parse(t),n=t.crawlId;let d=null!=(u=t.zys)?u:[];"string"==typeof d&&(d=JSON.parse(d));var h=Date.now();for(const c of d){var l={id:n+"-"+c.hash,type:"pathmatics",timestamp:h,details:c};null!=(y=this.config.logger)&&y.log("Ad detected",l);try{await(null==(o=(p=this.config).onAdDetected)?void 0:o.call(p,l))}catch(b){null!=(y=this.config.logger)&&y.error("onAdDetected failed",{err:b})}}await this.config.sendMessageToBackground({type:U.UPLOAD_CRAWL,payload:t}).catch(null==(u=this.config.logger)?void 0:u.error)}),this.messenger.onMessage("ads#GET_EXTERNAL_CONFIG",async()=>({response:await Y(this.config.sendMessageToBackground)})))}initPathmaticsScript(){null!=(r=this.config.logger)&&r.log("Initializing script");var r={enableLogs:null!=(r=this.config.enablePathmaticsLogs)&&r};this.messenger.sendMessage("ads#INIT",r)}};let q=j;function Q(t){return{...t,logger:void 0===t.logger?console:null!=(t=t.logger)?t:void 0}}q.MESSENGER_SUFFIX="-response",q.SUBFRAME_DOMAIN_BLOCKLIST=new Set(["google.com","okta.com","amazon.com"]),q.GOOGLE_AUTH_HOSTNAME="accounts.youtube.com";const pe=function(){var n;function d(u){return Number.isInteger(u)&&u>=0}function h(u){this.name="ArgumentError",this.message=u}return function(u,y){if(y=y||{},typeof u!="function")throw new h("fetch must be a function");if(typeof y!="object")throw new h("defaults must be an object");if(y.retries!==void 0&&!d(y.retries))throw new h("retries must be a positive integer");if(y.retryDelay!==void 0&&!d(y.retryDelay)&&typeof y.retryDelay!="function")throw new h("retryDelay must be a positive integer or a function returning a positive integer");if(y.retryOn!==void 0&&!Array.isArray(y.retryOn)&&typeof y.retryOn!="function")throw new h("retryOn property expects an array or function");var p={retries:3,retryDelay:1e3,retryOn:[]};return y=Object.assign(p,y),function(a,s){var c=y.retries,l=y.retryDelay,b=y.retryOn;if(s&&s.retries!==void 0)if(d(s.retries))c=s.retries;else throw new h("retries must be a positive integer");if(s&&s.retryDelay!==void 0)if(d(s.retryDelay)||typeof s.retryDelay=="function")l=s.retryDelay;else throw new h("retryDelay must be a positive integer or a function returning a positive integer");if(s&&s.retryOn)if(Array.isArray(s.retryOn)||typeof s.retryOn=="function")b=s.retryOn;else throw new h("retryOn property expects an array or function");return new Promise(function(O,T){var P=function(v){var E=typeof Request<"u"&&a instanceof Request?a.clone():a;u(E,s).then(function(m){if(Array.isArray(b)&&b.indexOf(m.status)===-1)O(m);else if(typeof b=="function")try{return Promise.resolve(b(v,null,m)).then(function(A){A?_(v,null,m):O(m)}).catch(T)}catch(A){T(A)}else v<c?_(v,null,m):O(m)}).catch(function(m){if(typeof b=="function")try{Promise.resolve(b(v,m,null)).then(function(A){A?_(v,m,null):T(m)}).catch(function(A){T(A)})}catch(A){T(A)}else v<c?_(v,m,null):T(m)})};function _(v,E,m){var A=typeof l=="function"?l(v,E,m):l;setTimeout(function(){P(++v)},A)}P(0)})}}}();function Ae(t){return pe(fetch,{retryOn(r,n,d){if(null!==n||500<=d.status)return null!=(n=t.logger)&&n.log("retrying, attempt number "+(r+1)),!0},retries:5,retryDelay(r){var r=500*Math.pow(2,r);return r=r,Math.random()*r+r/2}})}class we{constructor(r){this.config=r,this.fetch=Ae(r)}async upload(r){var u;await this.config.isEnabled()&&(r=this.prepareData(r),null!=(u=this.config.logger)&&u.log("Uploading data:",r),r=await this.fetch(this.config.crawlUploadUrl,{method:"POST",body:W.compressToUint8Array(JSON.stringify(r)),headers:{"Content-Type":"application/octet-stream"}}).then(o=>{var a;return null==(a=this.config.logger)?void 0:a.log({status:o.status})}).catch(null==(u=this.config.logger)?void 0:u.error),null!=(u=this.config.logger))&&u.log("Response:",r)}prepareData(r){return{...r,PartnerVersion:D.runtime.getManifest().version,ExtensionId:D.runtime.id,ExtensionVersion:this.config.extensionVersion,UserAgent:navigator.userAgent,BrowserLanguage:navigator.language,BlankZys:null,PanelPartnerId:this.config.panelPartnerId}}}async function ve(t){return function(t){if(null==(t=W.decompressFromUint8Array(new Uint8Array(t))))throw Error("Failed to convert string to ArrayBuffer");return t}(await fetch(t).then(n=>n.arrayBuffer()))}return L.PROD_PM_EXTERNAL_CONFIG_ENDPOINT="https://p.qljx.co/Ajax0001/Config",L.PROD_UPLOAD_CRAWL_ENDPOINT="https://p.qljx.co/Ajax0001/IPD",L.UNKNOWN_PARTNER_ID=0,L.initAdFinderInBackground=function(t){const r=Q(t),n=new we(r);return{async processAdFinderMessage(d){var h=u=>{var y;throw null!=(y=r.logger)&&y.error("Error handling message from ad-finder: "+JSON.stringify(d),u),u};switch(d.type){case U.UPLOAD_CRAWL:return n.upload(d.payload).catch(h);case U.GET_PM_EXTERNAL_CONFIG:return ve(t.pmExternalConfigUrl+"?installId="+await t.getInstallId()).catch(h);case U.FETCH_HTTP_RESPONSE:return fetch(d.payload).then(u=>{var p=parseInt(null!=(p=u.headers.get("Content-Length"))?p:"");return!isNaN(p)&&33554432<p?new ArrayBuffer(0):u.arrayBuffer()}).then(u=>33554432<u.byteLength?J(new ArrayBuffer(0)):J(u))}}}},L.initAdFinderInContentScript=function(t){var t=Q(t);new q(t).start().catch(null==(t=t.logger)?void 0:t.error)},Object.defineProperties(L,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),L}({});"function"==typeof define&&define.amd&&define(()=>adFinder);