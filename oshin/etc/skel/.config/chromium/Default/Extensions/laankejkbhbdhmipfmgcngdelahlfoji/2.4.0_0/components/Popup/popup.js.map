{"version":3,"file":"popup.js","sources":["../../../src/components/Popup/popup.tpl.html?raw","../../../src/components/Popup/PopupView.ts","../../../src/components/Popup/PopupModel.js","../../../src/components/Popup/PopupController.js","../../../src/components/PopupOnboardingRequired/template.html?raw","../../../src/components/PopupOnboardingRequired/View.js","../../../src/components/PopupOnboardingRequired/Controller.js","../../../src/components/Popup/main.js"],"sourcesContent":["export default \"<!-- Logo & Close -->\\n<header class=\\\"flex justify-between items-center gap-4 px-4 py-2 h-12\\\">\\n\\n  <div class=\\\"flex justify-start items-center gap-4\\\">\\n    <img\\n      class=\\\"h-8\\\"\\n      src=\\\"/common/img/logo.svg\\\"\\n      title=\\\"StayFocusd\\\"\\n      alt=\\\"StayFocusd\\\"\\n    />\\n    <!--  Add a switch html-->\\n    <div id=\\\"active-toggle-container\\\">\\n      <label class='switch switch-primary'>\\n        <input type='checkbox' class='toggle toggle-sm toggle-primary' id='active-toggle' checked />\\n      </label>\\n    </div>\\n  </div>\\n  <a\\n    class=\\\"close uppercase text-xs link link-primary link-hover font-medium\\\"\\n    href=\\\"#\\\"\\n    data-i18n=\\\"close\\\"\\n    >Close</a\\n  >\\n</header>\\n\\n<hr class=\\\"h-px border-neutral-focus p-0 m-0\\\" />\\n\\n<section class=\\\"activated-section flex gap-4 px-4 py-2 w-max min-w-[100%]\\\">\\n  <!-- Current website -->\\n  <div class=\\\"flex-1 flex flex-col\\\">\\n    <p\\n      class=\\\"text-sm opacity-50\\\"\\n      data-i18n=\\\"currentlyOn\\\"\\n    >\\n      You are currently on:\\n    </p>\\n    <p class=\\\"text-lg font-bold truncate\\\">{{baseDomain}}</p>\\n    <p\\n      id=\\\"status-msg\\\"\\n      class=\\\"mt-2 text-sm font-medium hidden\\\"\\n    ></p>\\n    <div id=\\\"addWebsiteToGroup\\\">\\n      <a\\n        id=\\\"block-entire\\\"\\n        class=\\\"mt-2 link link-secondary link-hover text-sm\\\"\\n        href=\\\"#\\\"\\n        title=\\\"Block all pages on this site\\\"\\n        data-analytics-click=\\\"CLICK_POPUP_BLOCK_ENTIRE_SITE\\\"\\n      >\\n        <strong data-i18n=\\\"block\\\">Block</strong>\\n        <span data-i18n=\\\"thisEntireSite\\\">this entire site</span>\\n      </a>\\n      <p class=\\\"text-sm opacity-50\\\">\\n        The entire site will be added to\\n        <strong><span id=\\\"groupName\\\">Default</span> group</strong>\\n      </p>\\n    </div>\\n    <a\\n      id=\\\"show-advanced-options\\\"\\n      class=\\\"mt-1 link link-hover text-sm\\\"\\n      href=\\\"#\\\"\\n      data-i18n=\\\"advancedOptions\\\"\\n    >\\n      Advanced options\\n    </a>\\n  </div>\\n\\n  <!-- Timer -->\\n  <div\\n    id=\\\"timer-container\\\"\\n    class=\\\"rounded self-center px-3 py-2 text-right\\\"\\n  >\\n    <div\\n      id=\\\"group-timer\\\"\\n      class=\\\"hidden\\\"\\n    >\\n      <p id=\\\"group-label\\\" class=\\\"uppercase text-xs opacity-50 whitespace-nowrap\\\">Group</p>\\n      <p\\n        id=\\\"group-name\\\"\\n        data-i18n=\\\"loading\\\"\\n        class=\\\"text-xl text-primary font-bold\\\"\\n      >\\n        Loading...\\n      </p>\\n    </div>\\n    <p\\n      id=\\\"timer-label\\\"\\n      data-i18n=\\\"timeRemaining\\\"\\n      class=\\\"uppercase text-xs opacity-50 whitespace-nowrap\\\"\\n    >\\n      Time Remaining\\n    </p>\\n    <div class=\\\"flex items-baseline gap-2 justify-end\\\">\\n      <p\\n        id=\\\"display-timer\\\"\\n        data-i18n=\\\"loading\\\"\\n        class=\\\"text-2xl text-primary font-bold\\\"\\n      >\\n        Loading...\\n      </p>\\n    </div>\\n  </div>\\n</section>\\n\\n<!-- Advanced -->\\n<section\\n  id=\\\"advanced-options\\\"\\n  class=\\\"px-4 pb-4 space-y-1\\\"\\n  style=\\\"display: none\\\"\\n>\\n  <a\\n    id=\\\"allow-entire\\\"\\n    class=\\\"block link link-hover link-accent text-sm\\\"\\n    href=\\\"#\\\"\\n    data-allow\\n  >\\n    <b data-i18n=\\\"allow\\\">Allow</b>\\n    <span data-i18n=\\\"thisEntireSite\\\">this entire site</span>\\n  </a>\\n  <a\\n    id=\\\"only-allow\\\"\\n    class=\\\"block link link-hover link-accent text-sm\\\"\\n    style=\\\"display: none\\\"\\n    href=\\\"#\\\"\\n    data-allow\\n  >\\n    <span data-i18n=\\\"onlyAllowPagesOn\\\">Only allow pages on</span>\\n    <strong>{{fullDomain}}</strong>\\n  </a>\\n  <a\\n    id=\\\"only-block\\\"\\n    class=\\\"block link link-hover link-secondary text-sm\\\"\\n    style=\\\"display: none\\\"\\n    href=\\\"#\\\"\\n  >\\n    <span data-i18n=\\\"onlyBlockPagesOn\\\">Only block pages on</span>\\n    <strong class=\\\"full-domain\\\">{{fullDomain}}</strong>\\n  </a>\\n\\n  <div class=\\\"bg-neutral px-4 py-3 rounded\\\">\\n    <label class=\\\"form-control\\\">\\n      <p>\\n        <span\\n          class=\\\"text-sm\\\"\\n          data-i18n=\\\"enterCustomURL\\\"\\n        >\\n          Enter a custom url\\n        </span>\\n      </p>\\n      <input\\n        id=\\\"custom-url\\\"\\n        class=\\\"input input-bordered input-sm my-1\\\"\\n        type=\\\"text\\\"\\n        value=\\\"\\\"\\n      />\\n    </label>\\n    <div class=\\\"flex gap-2\\\">\\n      <a\\n        id=\\\"block-custom\\\"\\n        class=\\\"link link-hover link-secondary text-sm\\\"\\n        href=\\\"#\\\"\\n        data-i18n=\\\"blockCustomURL\\\"\\n      >\\n        Block custom url\\n      </a>\\n      <p\\n        class=\\\"text-neutral-content text-opacity-50\\\"\\n        data-allow\\n      >\\n        &bull;\\n      </p>\\n      <a\\n        id=\\\"allow-custom\\\"\\n        class=\\\"link link-hover link-accent text-sm\\\"\\n        href=\\\"#\\\"\\n        data-i18n=\\\"allowCustomURL\\\"\\n        data-allow\\n      >\\n        Allow custom url\\n      </a>\\n    </div>\\n  </div>\\n</section>\\n\\n<section\\n  class='deactivated-section flex flex-col flex-1 items-center justify-center gap-2 px-4 py-4 w-max min-w-[100%] min-h-[120px]'>\\n  <h1\\n    class='font-bold text-center'\\n    data-i18n='deactivatedTitle'>\\n\\n  </h1>\\n  <p\\n    class='opacity-50 text-center'\\n    data-i18n='deactivatedText'\\n  >\\n  </p>\\n\\n  <iconify-icon\\n    id=\\\"power-icon\\\"\\n    class='icon-6xl cursor-pointer hover:text-primary text-base-content/50'\\n    icon='mdi:power'\\n    width='64'\\n    height='64' />\\n\\n</section>\\n\\n<hr class=\\\"activated-section h-px border-neutral-focus p-0 m-0\\\" />\\n\\n<footer class=\\\"activated-section flex items-center py-2 px-4 gap-1 justify-between\\\">\\n  <a\\n    id=\\\"show-nuclear-option\\\"\\n    class=\\\"link link-hover text-sm flex items-center gap-1\\\"\\n    href=\\\"#\\\"\\n  >\\n    <img\\n      class=\\\"inline w-4 h-4 shrink-0\\\"\\n      src=\\\"/common/img/icon-nuclear-16.png\\\"\\n      alt=\\\"Nuclear Option\\\"\\n      id=\\\"nuclearOptionIcon\\\"\\n    />\\n    <span data-i18n=\\\"nuclearOption\\\">Nuclear</span>\\n  </a>\\n  <p class=\\\"text-neutral-focus\\\">&bull;</p>\\n    <a\\n            id=\\\"show-dashboard\\\"\\n            class=\\\"link link-hover text-sm\\\"\\n            href=\\\"#\\\"\\n            data-i18n=\\\"dashboard\\\"\\n    >\\n        Dashboard\\n    </a>\\n    <p class=\\\"text-neutral-focus\\\">&bull;</p>\\n  <a\\n    id=\\\"show-options\\\"\\n    class=\\\"link link-hover text-sm\\\"\\n    href=\\\"#\\\"\\n    data-i18n=\\\"settings\\\"\\n  >\\n    Settings\\n  </a>\\n  <p class=\\\"text-neutral-focus\\\">&bull;</p>\\n  <a\\n    id=\\\"show-help\\\"\\n    class=\\\"link link-hover text-sm\\\"\\n    href=\\\"#\\\"\\n    data-i18n=\\\"helpFAQ\\\"\\n  >\\n    Help/FAQ\\n  </a>\\n  <p class=\\\"text-neutral-focus\\\">&bull;</p>\\n  <a\\n    class=\\\"link link-hover link-accent text-sm\\\"\\n    href=\\\"https://discord.com/invite/33kpwusY6Y\\\"\\n    target=\\\"_blank\\\"\\n    data-i18n=\\\"joinDiscord\\\"\\n  >\\n    Discord\\n  </a>\\n</footer>\\n\"","import API from '~/core/CoreAPI'\nimport $ from 'jquery'\nimport PubSub from 'dropletjs.pubsub'\nimport Brightline from 'brightline.js'\nimport popupTpl from './popup.tpl.html?raw'\nimport GeneralUtils from '~/core/GeneralUtils.js'\nimport { DisplayTimerResult } from '~/core/StayFocusd'\n\nconst log = GeneralUtils.createScopedLog('PopupView')\n\nconst DEFAULT_GROUP_NAME = 'Default'\n\nexport default class PopupView {\n  model = null as any | null\n\n  /**\n   * @param model PopupModel instance\n   */\n  constructor(model: any) {\n    log('constructor', 'Constructing PopupView', null, 'DEBUG')\n\n    this.model = model\n\n    PubSub.listen('Popup.timer.tick', this.updateDisplayTimer.bind(this))\n  }\n\n  /**\n   * Initializes PopupView\n   */\n  init() {\n    log('init', 'Initializing view', null, 'DEBUG')\n\n    this.inject()\n    this.addListeners()\n  }\n\n  /**\n   * Renders view\n   */\n  render() {\n    log('render', 'Rendering view')\n\n    const template = new Brightline(popupTpl)\n\n    template.set('baseDomain', this.model.baseDomain)\n    template.set('fullDomain', this.model.fullDomain)\n\n    return template.render()\n  }\n\n  /**\n   * Injects rendered view into page\n   */\n  inject() {\n    log('inject', 'Injecting view')\n\n    $('body').append(this.render())\n\n    /**\n     * Show \"only block [full domain]\" and \"only allow [full domain]\"\n     * when they are different than the base domain.\n     *\n     * In other words, if you're on cnn.com, the base and full domain\n     * are the same, so the full domain options are extraneous.\n     *\n     * However, if you're on www.cnn.com, then the base and full domains\n     * are different, so the full domain options should be shown.\n     */\n    if (this.model.fullDomain !== this.model.baseDomain) {\n      $('#only-allow, #only-block').show()\n    }\n\n    if (API.Settings.get('hideAllowSiteLink')) {\n      $('*[data-allow]').hide()\n    } else {\n      $('#allow-entire').show()\n    }\n\n    this.toggleActivated(API.StayFocusd.activated())\n    this.updateActiveSwitch(API.StayFocusd.isActivateSwitchShown())\n\n    if (this.model.isBlockAllWebsites) {\n      document.getElementById('addWebsiteToGroup')?.classList.add('hidden')\n      document.getElementById('only-block')?.classList.add('hidden')\n      document.getElementById('block-custom')?.classList.add('hidden')\n    }\n\n    if (API.BlockedGroupsRepository.isBlockable(this.model.baseDomain)) {\n      document.getElementById('addWebsiteToGroup')?.classList.add('hidden')\n    }\n\n    API.StayFocusd.localizeHTML(document)\n\n    this.bindUIHandlers()\n  }\n\n  /**\n   * Binds handlers to UI\n   */\n  bindUIHandlers() {\n    log('bindUIHandlers', 'Binding UI handlers', null, 'TRACE')\n\n    $('#show-help').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'help' })\n    })\n\n    $('#show-options').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'options' })\n    })\n\n    $('#show-nuclear-option').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'nuclearOption' })\n    })\n\n    $('#show-dashboard').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'dashboard' })\n    })\n\n    $('a.close').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'close' })\n    })\n\n    $('#showBlockedSitesOptions').click(function () {\n      PubSub.publish('PopupView.button.clicked', { button: 'blockedSites' })\n    })\n\n    $('#show-advanced-options').click(function () {\n      $('#advanced-options').slideToggle('fast')\n    })\n\n    $('#block-entire').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: this.model.baseDomain,\n        listType: 'black',\n        groupName: this.model.groupName ?? DEFAULT_GROUP_NAME,\n      })\n    })\n\n    $('#block-custom').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: $('#custom-url').val(),\n        listType: 'black',\n        groupName: this.model.groupName ?? DEFAULT_GROUP_NAME,\n      })\n    })\n\n    $('#allow-custom').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: $('#custom-url').val(),\n        listType: 'white',\n      })\n    })\n\n    $('#allow-entire').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: this.model.baseDomain,\n        listType: 'white',\n      })\n    })\n\n    $('#only-block').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: this.model.fullDomain,\n        listType: 'black',\n        groupName: this.model.groupName ?? DEFAULT_GROUP_NAME,\n      })\n    })\n\n    $('#only-allow').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'addToList',\n        domain: this.model.fullDomain,\n        listType: 'white',\n      })\n    })\n\n    $('#active-toggle').change(function (ev) {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'toggle',\n        value: (ev.target as HTMLInputElement).checked,\n      })\n    })\n\n    $('#power-icon').click(() => {\n      PubSub.publish('PopupView.button.clicked', {\n        button: 'toggle',\n        value: true,\n      })\n    })\n\n    API.Analytics.bindHtmlEvents()\n  }\n\n  /**\n   * Adds message listeners\n   */\n  addListeners() {\n    log('addListeners', 'Adding listeners', null, 'TRACE')\n\n    PubSub.listen(\n      '*.domain.added',\n      (message: string, payload: { success: boolean }) => {\n        this.showAddToListStatus(payload.success)\n      },\n    )\n\n    PubSub.listen(\n      'PopupModel.timer.updated',\n      (message: string, payload: { timer: DisplayTimerResult }) => {\n        this.updateDisplayTimer(payload.timer)\n      },\n    )\n\n    PubSub.listen(\n      'PopupModel.toggled',\n      (message: string, payload: { value: boolean }) => {\n        this.toggleActivated(payload.value)\n      },\n    )\n  }\n\n  /**\n   * Shows status message for \"add to list\" (success or error)\n   *\n   * @param success True if add was successful\n   */\n  showAddToListStatus(success: boolean) {\n    log(\n      'showAddToListStatus',\n      'Showing \"add to list\" status',\n      success ? 'SUCCESS' : 'ERROR',\n      'DEBUG',\n    )\n\n    if (success === true) {\n      $('#status-msg')\n        .removeClass('text-error')\n        .addClass('text-success')\n        .html(API.Chrome.Translation.get('success').toUpperCase() + '!')\n\n      setTimeout(function () {\n        window.close()\n      }, 1500)\n    } else {\n      $('#status-msg')\n        .removeClass('text-success')\n        .addClass('text-error')\n        .html(API.Chrome.Translation.get('error').toUpperCase())\n\n      setTimeout(function () {\n        $('#status-msg').hide()\n      }, 2000)\n    }\n\n    $('#status-msg').show()\n  }\n\n  toggleActivated(value: boolean) {\n    $('#active-toggle').prop('checked', value)\n    if (value) {\n      $('.activated-section').removeClass('hidden')\n      $('.deactivated-section').addClass('hidden')\n    } else {\n      $('.activated-section').addClass('hidden')\n      $('.deactivated-section').removeClass('hidden')\n    }\n  }\n\n  updateActiveSwitch(isActivatedShown: boolean) {\n    if (!isActivatedShown) {\n      $('#active-toggle-container').hide()\n    }\n  }\n\n  /**\n   * Updates display timer in popup with time remaining before block goes into effect\n   *\n   * @param timer The timer to display\n   */\n  updateDisplayTimer(timer: DisplayTimerResult) {\n    let displayTimer = ''\n    const $displayTimer = $('#display-timer')\n    const $groupNameElement = $('#group-name')\n    const $groupLabelElement = $('#group-label')\n    const $groupTimer = $('#group-timer')\n    const $nuclearRemainingIcon = $('#nuclearRemainingIcon')\n    const $timerContainer = $('#timer-container')\n\n    if (timer.nuclear) {\n      $timerContainer.addClass('bg-slate-900 text-yellow-300')\n      $displayTimer.addClass('text-yellow-300')\n      $groupNameElement.addClass('text-yellow-300')\n      $nuclearRemainingIcon.removeClass('hidden')\n      displayTimer = timer.time\n      $groupTimer.removeClass('hidden')\n      $groupLabelElement.text(API.Chrome.Translation.get('activeOption'))\n      $groupNameElement.html(API.Chrome.Translation.get('nuclear'))\n    } else {\n      $timerContainer.addClass('bg-neutral text-neutral-content')\n      $displayTimer.addClass('text-primary')\n      $groupNameElement.addClass('text-primary')\n      $nuclearRemainingIcon.addClass('hidden')\n      if (this.model.isActive() === false) {\n        displayTimer = API.Chrome.Translation.get('inactive')\n      } else if (this.model.isBlockAllWebsites == true) {\n        displayTimer = timer.time\n      } else {\n        $groupTimer.removeClass('hidden')\n        displayTimer = timer.time\n        this.model.groupName = timer.groupName\n\n        if (displayTimer === '00:00:00') {\n          $displayTimer.addClass('expired')\n        }\n        $groupNameElement.html(this.model.groupName)\n      }\n    }\n\n    if (this.model.groupName != null) {\n      document.getElementById('groupName')!.innerText = this.model.groupName\n    }\n\n    log(\n      'updateDisplayTimer',\n      'Updating display timer: ' + displayTimer,\n      null,\n      'DEBUG',\n    )\n\n    $displayTimer.html(displayTimer)\n  }\n}\n","import Logger from '~/core/Logger'\nimport API from '~/core/CoreAPI'\nimport PubSub from 'dropletjs.pubsub'\nimport DomainParser from '~/core/DomainParser'\nimport Message from '~/core/Message'\n\nvar log = function (funcName, message, payload, level) {\n  Logger.log('PopupModel.' + funcName, message, payload, level)\n}\n\nexport default class PopupModel {\n  url = null\n  timer = null\n  status = null // INACTIVE, ACTIVE, NUCLEAR, EXPIRED\n  fullDomain = null\n  baseDomain = null\n  isBlockAllWebsites = null\n  groupName = null\n  port = null\n\n  constructor() {\n    log('constructor', 'Constructing PopupModel', null, 'DEBUG')\n\n    this.status = 'INACTIVE'\n    this.isBlockAllWebsites = API.Settings.get('isBlockAllWebsites')\n    this.port = chrome.runtime.connect({ name: 'popup' })\n  }\n\n  /**\n   * Initializes model\n   */\n  async init() {\n    log('init', 'Initializing model', null, 'DEBUG')\n\n    await this.getCurrentUrl()\n\n    var self = this\n\n    /* Add listener */\n    this.port.onMessage.addListener(function ({ message, payload }) {\n      const messageObj = new Message(message)\n      if (message === 'StayFocusd.timer.updated') {\n        self.updateTimer(payload.displayTimer)\n        PubSub.publish('PopupModel.timer.updated', {\n          timer: payload.displayTimer,\n        })\n      } else if (messageObj.matches('*.domain.added.*')) {\n        PubSub.publish('PopupController.domain.added', {\n          success: payload.success,\n        })\n      } else if (messageObj.matches('StayFocusd.toggled.*.*')) {\n        PubSub.publish('PopupModel.toggled', payload)\n      }\n\n      return true\n    })\n  }\n\n  async getCurrentUrl() {\n    return new Promise((resolve, reject) => {\n      try {\n        chrome.tabs.query(\n          {\n            active: true,\n            currentWindow: true,\n          },\n          function (tabs) {\n            resolve(tabs[0].url)\n          },\n        )\n      } catch (e) {\n        reject(e)\n      }\n    }).then((url) => {\n      this.url = url\n      this.fullDomain = DomainParser.extractFullDomain(this.url)\n      this.baseDomain = DomainParser.extractBaseDomain(this.url)\n    })\n  }\n\n  /**\n   * Updates timer\n   *\n   * @param timer New timer value\n   */\n  updateTimer(timer) {\n    log('updateTimer', 'Updating timer', timer, 'TRACE')\n    this.timer = timer\n    this.updateStatus()\n  }\n\n  /**\n   * Updates popup timer status\n   */\n  updateStatus() {\n    var oldStatus = this.status\n\n    if (API.NuclearOption.isActive()) {\n      this.status = 'NUCLEAR'\n    } else if (API.StayFocusd.isActive() === false) {\n      this.status = 'INACTIVE'\n    } else {\n      this.status = 'ACTIVE'\n    }\n\n    if (this.status !== oldStatus) {\n      log('updateStatus', 'Updating status', this.status)\n    }\n  }\n\n  /**\n   * Checks whether timer is active\n   *\n   * @returns {boolean}\n   */\n  isActive() {\n    return this.status === 'ACTIVE'\n  }\n\n  /**\n   * Checks whether Nuclear Option is active\n   *\n   * @returns {boolean}\n   */\n  isNuclear() {\n    return this.status === 'NUCLEAR'\n  }\n}\n","import Logger from '~/core/Logger'\nimport API from '~/core/CoreAPI'\nimport PubSub from 'dropletjs.pubsub'\nimport View from './PopupView'\nimport Model from './PopupModel'\nimport BasePrompt from '~/components/Prompt/BasePrompt'\nimport { badgeIcons } from '~/core/badge-icons'\nimport Browser from 'webextension-polyfill'\n\nvar log = function (funcName, message, payload, level) {\n  Logger.log('PopupController.' + funcName, message, payload, level)\n}\n\nconst changeBadgeIcons = badgeIcons()\n\nexport default class PopupController {\n  view = null\n  model = null\n\n  constructor() {\n    log('constructor', 'Constructing PopupController', null, 'DEBUG')\n\n    this.model = new Model()\n    this.view = new View(this.model)\n  }\n\n  /**\n   * Initializes PopupController\n   */\n  async init() {\n    log('init', 'Initializing controller', null, 'DEBUG')\n\n    this.addListeners()\n\n    await this.model.init()\n    this.view.init()\n\n    // // TODO This logic doesn't feel right here\n    // /* If the extension has been updated, pop the update window */\n    // if (API.Storage.getHTML5('isUpdated') === 'true') {\n    //   var disableUpdatePopup = API.Storage.getHTML5('disableUpdatePopup')\n\n    //   if (disableUpdatePopup !== 'true' && disableUpdatePopup !== true) {\n    //     API.Chrome.Tab.create({\n    //       url: API.Chrome.Extension.getURL('update.html'),\n    //     })\n    //   }\n\n    //   API.Storage.remove('isUpdated')\n    // }\n\n    changeBadgeIcons.hideBadge()\n\n    const basePrompt = new BasePrompt()\n    basePrompt.init()\n  }\n\n  /**\n   * Adds message listeners\n   */\n  addListeners() {\n    log('addListeners', 'Adding listeners', null, 'TRACE')\n\n    var self = this\n\n    PubSub.listen(\n      'PopupView.button.clicked',\n      async function (message, payload) {\n        switch (payload.button) {\n          case 'help':\n          case 'options':\n            self.openPage(payload.button)\n            break\n          case 'nuclearOption':\n          case 'blockedSites':\n          case 'dashboard':\n            self.openPage('options', payload.button)\n            break\n          case 'close':\n            window.close()\n            break\n          case 'toggle':\n            if (!payload.value) {\n              self.openPage('options', 'dashboard', 'toggle=true')\n              break\n            }\n            self.toggle(payload.value)\n            break\n          case 'addToList':\n            self.addToList(payload.domain, payload.groupName, payload.listType)\n            break\n        }\n      },\n    )\n  }\n\n  /**\n   * Opens page in new tab\n   *\n   * @param page The page to open\n   * @param hash Optional hash in page to target\n   * @param search\n   */\n  openPage(page, hash, search) {\n    var url =\n      Browser.runtime.getURL(page + '.html') +\n      (search ? '?' + search : '') +\n      (hash ? '#' + hash : '')\n\n    log('openPage', 'Opening page', url)\n\n    API.Chrome.Tab.create({\n      url: url,\n    })\n  }\n\n  /**\n   * Adds domain to blacklist or whitelist, and displays status message\n   *\n   * @param domain The domain to add\n   * @param listType The list type (black or white)\n   * @param groupName The group name (null if blocked all websites)\n   */\n  addToList(domain, groupName, listType) {\n    log('addToList', 'Adding ' + domain + ' to ' + listType + 'list')\n\n    if (domain !== '') {\n      var descriptor = listType === 'black' ? 'BLACKLIST' : 'WHITELIST'\n\n      this.model.port.postMessage({\n        message: 'PopupController.domain.add.' + descriptor,\n        payload: {\n          domain: domain,\n          groupName: groupName,\n        },\n      })\n    }\n  }\n  toggle(value) {\n    log('toggle', 'Toggling extension', null, 'TRACE')\n\n    this.model.port.postMessage({\n      message: 'PopupController.toggle',\n      payload: {\n        value,\n      },\n    })\n  }\n}\n","export default \"<div class=\\\"flex flex-col gap-4 fixed inset-0 justify-center p-4 px-8 bg-base-100\\\">\\n    <h1 data-i18n=\\\"required\\\" class=\\\"text-lg font-bold\\\"></h1>\\n    <p id=\\\"tosMessage\\\" data-i18n=\\\"tosHaveChanged\\\" class=\\\"text-base\\\"></p>\\n    <p id=\\\"privacyPolicyMessage\\\" data-i18n=\\\"onboardingConfirmMessage\\\" class=\\\"text-base\\\"></p>\\n    <button id=\\\"btnOpenSettings\\\" class=\\\"btn btn-primary\\\" data-i18n=\\\"openSettings\\\" target=\\\"_blank\\\"></button>\\n</div>\\n\"","import API from '~/core/CoreAPI'\nimport Brightline from 'brightline.js'\nimport PubSub from 'dropletjs.pubsub'\nimport popupOnboardingRequiredTpl from './template.html?raw'\n\nvar log = API.Utils.createScopedLog('PopupOnboardingRequiredView')\n\nexport default class PopupOnboardingRequiredView {\n  constructor() {\n    log(\n      'constructor',\n      'Constructing PopupOnboardingRequiredView',\n      null,\n      'DEBUG',\n    )\n  }\n\n  init() {\n    log('init', 'Initializing view', null, 'DEBUG')\n    var template = new Brightline(popupOnboardingRequiredTpl)\n    document.body.innerHTML += template.render()\n\n    const hasAcceptedToS = API.Settings.get('hasAcceptedToS')\n    this.setVisible('tosMessage', !hasAcceptedToS)\n    this.setVisible('privacyPolicyMessage', hasAcceptedToS)\n\n    API.StayFocusd.localizeHTML(document)\n\n    this.bindUIHandlers()\n  }\n\n  setVisible(id, isVisible) {\n    const element = document.getElementById(id)\n    if (!element) return\n\n    if (isVisible) element.classList.remove('hidden')\n    else element.classList.add('hidden')\n  }\n\n  /**\n   * Adds event listeners and publishes events for the controller to listen to.\n   */\n  bindUIHandlers() {\n    log('bindUIHandlers', 'Binding UI handlers', null, 'TRACE')\n    document.querySelectorAll('.btn').forEach((btn) => {\n      btn.addEventListener('click', () => {\n        PubSub.publish('PopupOnboardingRequired.button.clicked', {\n          id: btn.id,\n        })\n      })\n    })\n\n    API.Analytics.bindHtmlEvents()\n  }\n}\n","//import API from '~/core/CoreAPI'\nimport PubSub from 'dropletjs.pubsub'\nimport View from './View'\nimport Browser from 'webextension-polyfill'\nimport API from '~/core/CoreAPI'\n\nvar log = API.Utils.createScopedLog('PopupOnboardingRequiredController')\n\nexport default class PopupOnboardingRequiredController {\n  view = null\n\n  constructor() {\n    log(\n      'constructor',\n      'Constructing PopupOnboardingRequiredController',\n      null,\n      'DEBUG',\n    )\n    this.view = new View()\n  }\n\n  async init() {\n    log('init', 'Initializing controller', null, 'DEBUG')\n    await Promise.all([API.Settings.initAsync(), API.Requirements.init()])\n\n    this.mountView()\n  }\n\n  async mountView() {\n    const isCompleted = await API.Requirements.isOnboardingCompleted()\n    if (isCompleted) return\n\n    API.Analytics.event('SHOW_POPUP_ACTION_REQUIRED')\n    this.view.init()\n    this.addListeners()\n  }\n\n  addListeners() {\n    log('addListeners', 'Adding listeners', null, 'TRACE')\n    PubSub.listen(\n      'PopupOnboardingRequired.button.clicked',\n      async (_, { id }) => {\n        switch (id) {\n          case 'btnOpenSettings':\n            API.Analytics.event('CLICK_POPUP_ACTION_REQUIRED_OPEN_SETTINGS')\n            await API.Chrome.Tab.create({\n              url: Browser.runtime.getURL('/options.html'),\n              active: true,\n            })\n            await this.dismiss()\n            break\n        }\n      },\n    )\n  }\n}\n","import API from '~/core/CoreAPI'\nimport $ from 'jquery'\nimport PopupController from './PopupController'\nimport PopupOnboardingRequiredController from '~/components/PopupOnboardingRequired/Controller'\nimport 'iconify-icon'\n\nAPI.Settings.init(function () {\n  var popupController = new PopupController()\n  var onboardingRequiredController = new PopupOnboardingRequiredController()\n\n  $(document).ready(function () {\n    API.Bugsnag.init('popup')\n    API.Analytics.init()\n    API.BlockedGroupsRepository.init()\n    popupController.init()\n    onboardingRequiredController.init()\n  })\n})\n"],"names":["popupTpl","log","GeneralUtils","DEFAULT_GROUP_NAME","PopupView","model","__publicField","PubSub","template","Brightline","$","API","_a","_b","_c","_d","ev","message","payload","success","value","isActivatedShown","timer","displayTimer","$displayTimer","$groupNameElement","$groupLabelElement","$groupTimer","$nuclearRemainingIcon","$timerContainer","funcName","level","Logger","PopupModel","self","messageObj","Message","resolve","reject","tabs","e","url","DomainParser","oldStatus","changeBadgeIcons","badgeIcons","PopupController","Model","View","BasePrompt","page","hash","search","Browser","domain","groupName","listType","descriptor","popupOnboardingRequiredTpl","PopupOnboardingRequiredView","hasAcceptedToS","id","isVisible","element","btn","PopupOnboardingRequiredController","_","popupController","onboardingRequiredController"],"mappings":"ibAAA,MAAeA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA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"}